; generated by Component: ARM Compiler 5.06 update 6 (build 750) Tool: ArmCC [4d3637]
; commandline ArmCC [--c99 --list --split_sections --debug -c --asm --interleave -o.\short_wave\obj\alarm.o --asm_dir=.\short_wave\List\ --list_dir=.\short_wave\List\ --depend=.\short_wave\obj\alarm.d --cpu=Cortex-M3 --apcs=interwork -O0 --diag_suppress=9931,870 -I..\..\Libraries\CMSIS\Device\ST\STM32F10x\Include -I..\..\Libraries\STM32F10x_StdPeriph_Driver\inc -I..\..\User\bsp -I..\..\User\bsp\inc -I..\..\User -I..\..\Libraries\CMSIS\Include -I..\..\FreeRTOS\include -I..\..\FreeRTOS\portable\RVDS\ARM_CM3 -I..\..\User\adc -I..\..\User\rtc -I..\..\User\internal_flash -I..\..\User\iwdg -I..\..\Task -I..\..\User\can -I..\..\User\firmware_upgrade -I..\..\User\STMFLASH -I..\..\User\IAP -I.\RTE\_Short_Wave -IC:\Keil_v5\ARM\PACK\Keil\STM32F1xx_DFP\2.3.0\Device\Include -IC:\Keil_v5\ARM\CMSIS\Include -D__MICROLIB -D__UVISION_VERSION=525 -DSTM32F10X_HD -DUSE_STDPERIPH_DRIVER -DSTM32F10X_HD --omf_browse=.\short_wave\obj\alarm.crf ..\..\User\alarm.c]
                          THUMB

                          AREA ||i.Read_Sum_AD||, CODE, READONLY, ALIGN=2

                  Read_Sum_AD PROC
;;;12     /* 读AD并取平均值 */
;;;13     void Read_Sum_AD(void)
000000  e92d4ff0          PUSH     {r4-r11,lr}
;;;14     {
000004  b085              SUB      sp,sp,#0x14
;;;15         uint8_t i=0;
000006  f04f0a00          MOV      r10,#0
;;;16         float temp_adc_sum_f = 0;
00000a  2000              MOVS     r0,#0
00000c  9004              STR      r0,[sp,#0x10]
;;;17         float temp_adc_sum_r = 0;
00000e  9003              STR      r0,[sp,#0xc]
;;;18         float temp_adc_sum_v = 0;
000010  9002              STR      r0,[sp,#8]
;;;19         float temp_adc_sum_a = 0;
000012  9001              STR      r0,[sp,#4]
;;;20     
;;;21         for(i=0; i<AD_SAMPLE_NUM; i++)	//读取AD
000014  bf00              NOP      
000016  e077              B        |L1.264|
                  |L1.24|
;;;22         {
;;;23             ADC0_buff[i] = (float) ADC_ConvertedValue[0]/4096*3.3*3;
000018  4977              LDR      r1,|L1.504|
00001a  8808              LDRH     r0,[r1,#0]  ; ADC_ConvertedValue
00001c  f7fffffe          BL       __aeabi_ui2f
000020  f04f418b          MOV      r1,#0x45800000
000024  9000              STR      r0,[sp,#0]
000026  f7fffffe          BL       __aeabi_fdiv
00002a  4683              MOV      r11,r0
00002c  f7fffffe          BL       __aeabi_f2d
000030  4606              MOV      r6,r0
000032  f04f3266          MOV      r2,#0x66666666
000036  4b71              LDR      r3,|L1.508|
000038  f7fffffe          BL       __aeabi_dmul
00003c  4680              MOV      r8,r0
00003e  2200              MOVS     r2,#0
000040  4b6f              LDR      r3,|L1.512|
000042  f7fffffe          BL       __aeabi_dmul
000046  4604              MOV      r4,r0
000048  f7fffffe          BL       __aeabi_d2f
00004c  496d              LDR      r1,|L1.516|
00004e  f841002a          STR      r0,[r1,r10,LSL #2]
;;;24             ADC1_buff[i] = (float) ADC_ConvertedValue[1]/4096*3.3;
000052  4969              LDR      r1,|L1.504|
000054  8848              LDRH     r0,[r1,#2]  ; ADC_ConvertedValue
000056  f7fffffe          BL       __aeabi_ui2f
00005a  4681              MOV      r9,r0
00005c  f04f418b          MOV      r1,#0x45800000
000060  f7fffffe          BL       __aeabi_fdiv
000064  4680              MOV      r8,r0
000066  f7fffffe          BL       __aeabi_f2d
00006a  4606              MOV      r6,r0
00006c  f04f3266          MOV      r2,#0x66666666
000070  4b62              LDR      r3,|L1.508|
000072  f7fffffe          BL       __aeabi_dmul
000076  4604              MOV      r4,r0
000078  f7fffffe          BL       __aeabi_d2f
00007c  4962              LDR      r1,|L1.520|
00007e  f841002a          STR      r0,[r1,r10,LSL #2]
;;;25             ADC2_buff[i] = (float) ADC_ConvertedValue[2]/4096*3.3*2;
000082  495d              LDR      r1,|L1.504|
000084  8888              LDRH     r0,[r1,#4]  ; ADC_ConvertedValue
000086  f7fffffe          BL       __aeabi_ui2f
00008a  f04f418b          MOV      r1,#0x45800000
00008e  9000              STR      r0,[sp,#0]
000090  f7fffffe          BL       __aeabi_fdiv
000094  4683              MOV      r11,r0
000096  f7fffffe          BL       __aeabi_f2d
00009a  4680              MOV      r8,r0
00009c  f04f3266          MOV      r2,#0x66666666
0000a0  4b56              LDR      r3,|L1.508|
0000a2  f7fffffe          BL       __aeabi_dmul
0000a6  4606              MOV      r6,r0
0000a8  2200              MOVS     r2,#0
0000aa  f04f4380          MOV      r3,#0x40000000
0000ae  f7fffffe          BL       __aeabi_dmul
0000b2  4604              MOV      r4,r0
0000b4  f7fffffe          BL       __aeabi_d2f
0000b8  4954              LDR      r1,|L1.524|
0000ba  f841002a          STR      r0,[r1,r10,LSL #2]
;;;26             ADC3_buff[i] = (float) ADC_ConvertedValue[3]/4096*3.3*2;
0000be  494e              LDR      r1,|L1.504|
0000c0  88c8              LDRH     r0,[r1,#6]  ; ADC_ConvertedValue
0000c2  f7fffffe          BL       __aeabi_ui2f
0000c6  f04f418b          MOV      r1,#0x45800000
0000ca  9000              STR      r0,[sp,#0]
0000cc  f7fffffe          BL       __aeabi_fdiv
0000d0  4683              MOV      r11,r0
0000d2  f7fffffe          BL       __aeabi_f2d
0000d6  4680              MOV      r8,r0
0000d8  f04f3266          MOV      r2,#0x66666666
0000dc  4b47              LDR      r3,|L1.508|
0000de  f7fffffe          BL       __aeabi_dmul
0000e2  4606              MOV      r6,r0
0000e4  2200              MOVS     r2,#0
0000e6  f04f4380          MOV      r3,#0x40000000
0000ea  f7fffffe          BL       __aeabi_dmul
0000ee  4604              MOV      r4,r0
0000f0  f7fffffe          BL       __aeabi_d2f
0000f4  4946              LDR      r1,|L1.528|
0000f6  f841002a          STR      r0,[r1,r10,LSL #2]
;;;27             vTaskDelay(1);
0000fa  2001              MOVS     r0,#1
0000fc  f7fffffe          BL       vTaskDelay
000100  f10a0001          ADD      r0,r10,#1             ;21
000104  f0000aff          AND      r10,r0,#0xff          ;21
                  |L1.264|
000108  f1ba0f32          CMP      r10,#0x32             ;21
00010c  db84              BLT      |L1.24|
;;;28         }
;;;29     
;;;30         adc1_zero_count = 0;
00010e  2000              MOVS     r0,#0
000110  4940              LDR      r1,|L1.532|
000112  7008              STRB     r0,[r1,#0]
;;;31         adc3_zero_count = 0;
000114  4940              LDR      r1,|L1.536|
000116  7008              STRB     r0,[r1,#0]
;;;32         for(i=1; i<AD_SAMPLE_NUM; i++)
000118  f04f0a01          MOV      r10,#1
00011c  e03f              B        |L1.414|
                  |L1.286|
;;;33         {
;;;34             temp_adc_sum_f += ADC0_buff[i];		//正向功率
00011e  4839              LDR      r0,|L1.516|
000120  f850102a          LDR      r1,[r0,r10,LSL #2]
000124  9804              LDR      r0,[sp,#0x10]
000126  f7fffffe          BL       __aeabi_fadd
00012a  9004              STR      r0,[sp,#0x10]
;;;35             temp_adc_sum_r += ADC1_buff[i];		//反向功率
00012c  4836              LDR      r0,|L1.520|
00012e  f850102a          LDR      r1,[r0,r10,LSL #2]
000132  9803              LDR      r0,[sp,#0xc]
000134  f7fffffe          BL       __aeabi_fadd
000138  9003              STR      r0,[sp,#0xc]
;;;36             temp_adc_sum_v += ADC2_buff[i];		//电压
00013a  4834              LDR      r0,|L1.524|
00013c  f850102a          LDR      r1,[r0,r10,LSL #2]
000140  9802              LDR      r0,[sp,#8]
000142  f7fffffe          BL       __aeabi_fadd
000146  9002              STR      r0,[sp,#8]
;;;37             temp_adc_sum_a += ADC3_buff[i];		//电流
000148  4831              LDR      r0,|L1.528|
00014a  f850102a          LDR      r1,[r0,r10,LSL #2]
00014e  9801              LDR      r0,[sp,#4]
000150  f7fffffe          BL       __aeabi_fadd
000154  9001              STR      r0,[sp,#4]
;;;38     
;;;39             if(  ADC1_buff[i] < 0.001 )
000156  492c              LDR      r1,|L1.520|
000158  f851002a          LDR      r0,[r1,r10,LSL #2]
00015c  f7fffffe          BL       __aeabi_f2d
000160  4604              MOV      r4,r0
000162  4a2e              LDR      r2,|L1.540|
000164  4b2e              LDR      r3,|L1.544|
000166  f7fffffe          BL       __aeabi_cdcmple
00016a  d204              BCS      |L1.374|
;;;40                 adc1_zero_count++;
00016c  4829              LDR      r0,|L1.532|
00016e  7800              LDRB     r0,[r0,#0]  ; adc1_zero_count
000170  1c40              ADDS     r0,r0,#1
000172  4928              LDR      r1,|L1.532|
000174  7008              STRB     r0,[r1,#0]
                  |L1.374|
;;;41     
;;;42             if(  ADC3_buff[i] < 0.001 )
000176  4926              LDR      r1,|L1.528|
000178  f851002a          LDR      r0,[r1,r10,LSL #2]
00017c  f7fffffe          BL       __aeabi_f2d
000180  4604              MOV      r4,r0
000182  4a26              LDR      r2,|L1.540|
000184  4b26              LDR      r3,|L1.544|
000186  f7fffffe          BL       __aeabi_cdcmple
00018a  d204              BCS      |L1.406|
;;;43                 adc3_zero_count++;
00018c  4822              LDR      r0,|L1.536|
00018e  7800              LDRB     r0,[r0,#0]  ; adc3_zero_count
000190  1c40              ADDS     r0,r0,#1
000192  4921              LDR      r1,|L1.536|
000194  7008              STRB     r0,[r1,#0]
                  |L1.406|
000196  f10a0001          ADD      r0,r10,#1             ;32
00019a  f0000aff          AND      r10,r0,#0xff          ;32
                  |L1.414|
00019e  f1ba0f32          CMP      r10,#0x32             ;32
0001a2  dbbc              BLT      |L1.286|
;;;44         }
;;;45     
;;;46         System.ADC_Sum_F	= temp_adc_sum_f/AD_SAMPLE_NUM;						//正向功率
0001a4  491f              LDR      r1,|L1.548|
0001a6  9804              LDR      r0,[sp,#0x10]
0001a8  f7fffffe          BL       __aeabi_fdiv
0001ac  491e              LDR      r1,|L1.552|
0001ae  65c8              STR      r0,[r1,#0x5c]  ; System
;;;47         System.ADC_Sum_R	= temp_adc_sum_r/(AD_SAMPLE_NUM-adc1_zero_count);	//反向功率
0001b0  4918              LDR      r1,|L1.532|
0001b2  7809              LDRB     r1,[r1,#0]  ; adc1_zero_count
0001b4  f1c10032          RSB      r0,r1,#0x32
0001b8  f7fffffe          BL       __aeabi_i2f
0001bc  4604              MOV      r4,r0
0001be  4621              MOV      r1,r4
0001c0  9803              LDR      r0,[sp,#0xc]
0001c2  f7fffffe          BL       __aeabi_fdiv
0001c6  4918              LDR      r1,|L1.552|
0001c8  6608              STR      r0,[r1,#0x60]  ; System
;;;48         System.ADC_Sum_V	= temp_adc_sum_v/AD_SAMPLE_NUM;						//电压
0001ca  4916              LDR      r1,|L1.548|
0001cc  9802              LDR      r0,[sp,#8]
0001ce  f7fffffe          BL       __aeabi_fdiv
0001d2  4915              LDR      r1,|L1.552|
0001d4  6648              STR      r0,[r1,#0x64]  ; System
;;;49         System.ADC_Sum_A	= temp_adc_sum_a/(AD_SAMPLE_NUM-adc3_zero_count);	//电流
0001d6  4910              LDR      r1,|L1.536|
0001d8  7809              LDRB     r1,[r1,#0]  ; adc3_zero_count
0001da  f1c10032          RSB      r0,r1,#0x32
0001de  f7fffffe          BL       __aeabi_i2f
0001e2  4604              MOV      r4,r0
0001e4  4621              MOV      r1,r4
0001e6  9801              LDR      r0,[sp,#4]
0001e8  f7fffffe          BL       __aeabi_fdiv
0001ec  490e              LDR      r1,|L1.552|
0001ee  6688              STR      r0,[r1,#0x68]  ; System
;;;50     }
0001f0  b005              ADD      sp,sp,#0x14
0001f2  e8bd8ff0          POP      {r4-r11,pc}
;;;51     
                          ENDP

0001f6  0000              DCW      0x0000
                  |L1.504|
                          DCD      ADC_ConvertedValue
                  |L1.508|
                          DCD      0x400a6666
                  |L1.512|
                          DCD      0x40080000
                  |L1.516|
                          DCD      ADC0_buff
                  |L1.520|
                          DCD      ADC1_buff
                  |L1.524|
                          DCD      ADC2_buff
                  |L1.528|
                          DCD      ADC3_buff
                  |L1.532|
                          DCD      adc1_zero_count
                  |L1.536|
                          DCD      adc3_zero_count
                  |L1.540|
                          DCD      0xd2f1a9fc
                  |L1.544|
                          DCD      0x3f50624d
                  |L1.548|
                          DCD      0x42480000
                  |L1.552|
                          DCD      System

                          AREA ||i.VA_alarm_check||, CODE, READONLY, ALIGN=2

                  VA_alarm_check PROC
;;;52     /* 电压电流报警检测 */
;;;53     void VA_alarm_check(void)
000000  e92d47f0          PUSH     {r4-r10,lr}
;;;54     {
;;;55         if( (System.emission == 0x01) && (System.stop == 0x00) )	//正在发射，且没有正在停止
000004  48ec              LDR      r0,|L2.952|
000006  7d80              LDRB     r0,[r0,#0x16]  ; System
000008  2801              CMP      r0,#1
                  |L2.10|
00000a  d17c              BNE      |L2.262|
00000c  48ea              LDR      r0,|L2.952|
00000e  7d40              LDRB     r0,[r0,#0x15]  ; System
000010  2800              CMP      r0,#0
000012  d1fa              BNE      |L2.10|
;;;56         {
;;;57             if( Alarm.over_Electric == 0 )												//过流报警检测
000014  48e9              LDR      r0,|L2.956|
000016  7ac0              LDRB     r0,[r0,#0xb]  ; Alarm
000018  2800              CMP      r0,#0
00001a  d13e              BNE      |L2.154|
;;;58             {
;;;59                 if( System.Electricity >= Alarm_threshold.Upp_45I_limit[0] )
00001c  4ae8              LDR      r2,|L2.960|
00001e  6951              LDR      r1,[r2,#0x14]  ; Alarm_threshold
000020  4ae5              LDR      r2,|L2.952|
000022  6f90              LDR      r0,[r2,#0x78]  ; System
000024  f7fffffe          BL       __aeabi_cfrcmple
000028  d838              BHI      |L2.156|
;;;60                 {
;;;61                     if( System.time_update_flag == 0x01 )
00002a  48e3              LDR      r0,|L2.952|
00002c  7a80              LDRB     r0,[r0,#0xa]  ; System
00002e  2801              CMP      r0,#1
000030  d12a              BNE      |L2.136|
;;;62                     {
;;;63                         Alarm.over_Electric_time_flag = 0x01;
000032  49e2              LDR      r1,|L2.956|
000034  7308              STRB     r0,[r1,#0xc]
;;;64                         Time_Printf( (RTC_GetCounter()+g_stamp_distance), &set_time );
000036  f7fffffe          BL       RTC_GetCounter
00003a  49e2              LDR      r1,|L2.964|
00003c  6809              LDR      r1,[r1,#0]  ; g_stamp_distance
00003e  1844              ADDS     r4,r0,r1
000040  49e1              LDR      r1,|L2.968|
000042  4620              MOV      r0,r4
000044  f7fffffe          BL       Time_Printf
;;;65                         Alarm_historyBack.power_45A_time[0]=set_time.tm_year-2000;
000048  48df              LDR      r0,|L2.968|
00004a  7d00              LDRB     r0,[r0,#0x14]  ; set_time
00004c  f5a060fa          SUB      r0,r0,#0x7d0
000050  49de              LDR      r1,|L2.972|
000052  f8810021          STRB     r0,[r1,#0x21]
;;;66                         Alarm_historyBack.power_45A_time[1]=set_time.tm_mon;
000056  48dc              LDR      r0,|L2.968|
000058  7c01              LDRB     r1,[r0,#0x10]  ; set_time
00005a  48dc              LDR      r0,|L2.972|
00005c  f8801022          STRB     r1,[r0,#0x22]
;;;67                         Alarm_historyBack.power_45A_time[2]=set_time.tm_mday;
000060  48d9              LDR      r0,|L2.968|
000062  7b01              LDRB     r1,[r0,#0xc]  ; set_time
000064  48d9              LDR      r0,|L2.972|
000066  f8801023          STRB     r1,[r0,#0x23]
;;;68                         Alarm_historyBack.power_45A_time[3]=set_time.tm_hour;
00006a  48d7              LDR      r0,|L2.968|
00006c  7a01              LDRB     r1,[r0,#8]  ; set_time
00006e  48d7              LDR      r0,|L2.972|
000070  f8801024          STRB     r1,[r0,#0x24]
;;;69                         Alarm_historyBack.power_45A_time[4]=set_time.tm_min;
000074  48d4              LDR      r0,|L2.968|
000076  7901              LDRB     r1,[r0,#4]  ; set_time
000078  48d4              LDR      r0,|L2.972|
00007a  f8801025          STRB     r1,[r0,#0x25]
;;;70                         Alarm_historyBack.power_45A_time[5]=set_time.tm_sec;
00007e  48d2              LDR      r0,|L2.968|
000080  7801              LDRB     r1,[r0,#0]  ; set_time
000082  48d2              LDR      r0,|L2.972|
000084  f8801026          STRB     r1,[r0,#0x26]
                  |L2.136|
;;;71                     }
;;;72     
;;;73                     Alarm.alarm_history = 1;
000088  2001              MOVS     r0,#1
00008a  49cc              LDR      r1,|L2.956|
00008c  7008              STRB     r0,[r1,#0]
;;;74                     Alarm.over_Electric = 1;
00008e  72c8              STRB     r0,[r1,#0xb]
;;;75                     Alarm_historyBack.power_45A_history[0] = System.Electricity;
000090  48c9              LDR      r0,|L2.952|
000092  6f80              LDR      r0,[r0,#0x78]  ; System
000094  49cd              LDR      r1,|L2.972|
000096  f8c1001d          STR      r0,[r1,#0x1d]  ; Alarm_historyBack
                  |L2.154|
00009a  e064              B        |L2.358|
                  |L2.156|
;;;76                 }
;;;77     			else	if( (System.Electricity >= (PROTECT_ADJUST*Alarm_threshold.Upp_45I_limit[0]) ) && (System.sweep != 0x01 ) )
00009c  49c8              LDR      r1,|L2.960|
00009e  6948              LDR      r0,[r1,#0x14]  ; Alarm_threshold
0000a0  f7fffffe          BL       __aeabi_f2d
0000a4  4606              MOV      r6,r0
0000a6  f04f3266          MOV      r2,#0x66666666
0000aa  4bc9              LDR      r3,|L2.976|
0000ac  f7fffffe          BL       __aeabi_dmul
0000b0  4604              MOV      r4,r0
0000b2  460d              MOV      r5,r1
0000b4  49c0              LDR      r1,|L2.952|
0000b6  6f88              LDR      r0,[r1,#0x78]  ; System
0000b8  f7fffffe          BL       __aeabi_f2d
0000bc  4680              MOV      r8,r0
0000be  4622              MOV      r2,r4
0000c0  462b              MOV      r3,r5
0000c2  f7fffffe          BL       __aeabi_cdrcmple
0000c6  d83b              BHI      |L2.320|
0000c8  48bb              LDR      r0,|L2.952|
0000ca  7b80              LDRB     r0,[r0,#0xe]  ; System
0000cc  2801              CMP      r0,#1
0000ce  d037              BEQ      |L2.320|
;;;78     			{
;;;79     				if( System.Forward_Power < 500 )				//减小功率到500W，电流都大于PROTECT_ADJUST，不再做处理了
0000d0  49b9              LDR      r1,|L2.952|
0000d2  6ec8              LDR      r0,[r1,#0x6c]  ; System
0000d4  49bf              LDR      r1,|L2.980|
0000d6  f7fffffe          BL       __aeabi_cfcmple
0000da  d203              BCS      |L2.228|
;;;80     				{
;;;81     					System.protect_adjust = 0x00;
0000dc  2000              MOVS     r0,#0
0000de  49b6              LDR      r1,|L2.952|
0000e0  7508              STRB     r0,[r1,#0x14]
0000e2  e040              B        |L2.358|
                  |L2.228|
;;;82     				}
;;;83     				else	if( System.protect_adjust == 0x01 )		//正在减小功率，等待，不做处理
0000e4  48b4              LDR      r0,|L2.952|
0000e6  7d00              LDRB     r0,[r0,#0x14]  ; System
0000e8  2801              CMP      r0,#1
0000ea  d03c              BEQ      |L2.358|
;;;84     				{
;;;85     					
;;;86     				}
;;;87     				else
;;;88     				{
;;;89     					System.protect_adjust = 0x01;
0000ec  2001              MOVS     r0,#1
0000ee  49b2              LDR      r1,|L2.952|
0000f0  7508              STRB     r0,[r1,#0x14]
;;;90     					Sub_Power.Power_DOWN[0] = 50;
0000f2  2032              MOVS     r0,#0x32
0000f4  49b8              LDR      r1,|L2.984|
0000f6  7048              STRB     r0,[r1,#1]
;;;91     					
;;;92     					if( System.modify_power == 0x01 )
0000f8  48af              LDR      r0,|L2.952|
0000fa  7c80              LDRB     r0,[r0,#0x12]  ; System
0000fc  2801              CMP      r0,#1
0000fe  d103              BNE      |L2.264|
;;;93     					{
;;;94     						System.cancel_add_sub = 1;
000100  49ad              LDR      r1,|L2.952|
000102  74c8              STRB     r0,[r1,#0x13]
000104  e005              B        |L2.274|
                  |L2.262|
000106  e0c0              B        |L2.650|
                  |L2.264|
;;;95     					}
;;;96     					else
;;;97     					{
;;;98     						System.cancel_add_sub = 0;
000108  2000              MOVS     r0,#0
00010a  49ab              LDR      r1,|L2.952|
00010c  74c8              STRB     r0,[r1,#0x13]
;;;99     						System.modify_power = 0x01;
00010e  2001              MOVS     r0,#1
000110  7488              STRB     r0,[r1,#0x12]
                  |L2.274|
;;;100    					}
;;;101    
;;;102    					if( get_history_alarm() == 0x01 )
000112  f7fffffe          BL       get_history_alarm
000116  2801              CMP      r0,#1
000118  d103              BNE      |L2.290|
;;;103    					{
;;;104    						System.status = SYSTEM_ALARM;
00011a  2011              MOVS     r0,#0x11
00011c  49a6              LDR      r1,|L2.952|
00011e  72c8              STRB     r0,[r1,#0xb]
000120  e002              B        |L2.296|
                  |L2.290|
;;;105    					}
;;;106    					else
;;;107    					{
;;;108    						System.status = SYSTEM_EMISSING;
000122  2001              MOVS     r0,#1
000124  49a4              LDR      r1,|L2.952|
000126  72c8              STRB     r0,[r1,#0xb]
                  |L2.296|
;;;109    					}
;;;110    
;;;111    					System.stop = 0x00;
000128  2000              MOVS     r0,#0
00012a  49a3              LDR      r1,|L2.952|
00012c  7548              STRB     r0,[r1,#0x15]
;;;112    					System.cancel_sweeping = 0x00;
00012e  73c8              STRB     r0,[r1,#0xf]
;;;113    	//				Sub_PowerBack.results[0]=0xFE;		//减小成功
;;;114    
;;;115    	//				App_printf("Task_Upper_Computer Sub Notify!\r\n");
;;;116    					xTaskNotify(xHandleTask_MT2000,	/* 减小功率 */
000130  2300              MOVS     r3,#0
000132  2201              MOVS     r2,#1
000134  2104              MOVS     r1,#4
000136  48a9              LDR      r0,|L2.988|
000138  6800              LDR      r0,[r0,#0]  ; xHandleTask_MT2000
00013a  f7fffffe          BL       xTaskGenericNotify
00013e  e012              B        |L2.358|
                  |L2.320|
;;;117    								BIT_2,
;;;118    								eSetBits);
;;;119    				}
;;;120    			}
;;;121    			else	//正常
;;;122    			{
;;;123    				if( System.Standing_wave_ratio > (PROTECT_ADJUST*(SWR_ALARM_THRESHOLD/10.0)) )	//虽然电流正常，但是驻波比需要保护调节，这里不做处理
000140  499d              LDR      r1,|L2.952|
000142  6fc8              LDR      r0,[r1,#0x7c]  ; System
000144  f7fffffe          BL       __aeabi_f2d
000148  4604              MOV      r4,r0
00014a  4aa5              LDR      r2,|L2.992|
00014c  4ba5              LDR      r3,|L2.996|
00014e  f7fffffe          BL       __aeabi_cdrcmple
000152  d308              BCC      |L2.358|
;;;124    				{
;;;125    					
;;;126    				}
;;;127    				else	if( System.protect_adjust == 0x01 )								//保护调节成功，调节结束，取消减小功率
000154  4898              LDR      r0,|L2.952|
000156  7d00              LDRB     r0,[r0,#0x14]  ; System
000158  2801              CMP      r0,#1
00015a  d104              BNE      |L2.358|
;;;128    				{
;;;129    					System.protect_adjust = 0x00;
00015c  2000              MOVS     r0,#0
00015e  4996              LDR      r1,|L2.952|
000160  7508              STRB     r0,[r1,#0x14]
;;;130    					System.cancel_add_sub = 0x01;
000162  2001              MOVS     r0,#1
000164  74c8              STRB     r0,[r1,#0x13]
                  |L2.358|
;;;131    				}
;;;132    				else																	//正常的增减/发射/扫频
;;;133    				{
;;;134    					
;;;135    				}
;;;136    			}
;;;137            }
;;;138    		
;;;139            if( System.Voltage >= Alarm_threshold.Upp_45V_limit[0] )					//电压报警(过压)
000166  4a96              LDR      r2,|L2.960|
000168  69d1              LDR      r1,[r2,#0x1c]  ; Alarm_threshold
00016a  4a93              LDR      r2,|L2.952|
00016c  6f50              LDR      r0,[r2,#0x74]  ; System
00016e  f7fffffe          BL       __aeabi_cfrcmple
000172  d83f              BHI      |L2.500|
;;;140            {
;;;141                if( Alarm.over_Voltage == 0 )
000174  4891              LDR      r0,|L2.956|
000176  7b40              LDRB     r0,[r0,#0xd]  ; Alarm
000178  2800              CMP      r0,#0
00017a  d13a              BNE      |L2.498|
;;;142                {
;;;143                    if( System.time_update_flag == 0x01 )
00017c  488e              LDR      r0,|L2.952|
00017e  7a80              LDRB     r0,[r0,#0xa]  ; System
000180  2801              CMP      r0,#1
000182  d12a              BNE      |L2.474|
;;;144                    {
;;;145                        Alarm.over_Voltage_time_flag = 0x01;
000184  498d              LDR      r1,|L2.956|
000186  7388              STRB     r0,[r1,#0xe]
;;;146                        Time_Printf( (RTC_GetCounter()+g_stamp_distance), &set_time );
000188  f7fffffe          BL       RTC_GetCounter
00018c  498d              LDR      r1,|L2.964|
00018e  6809              LDR      r1,[r1,#0]  ; g_stamp_distance
000190  1844              ADDS     r4,r0,r1
000192  498d              LDR      r1,|L2.968|
000194  4620              MOV      r0,r4
000196  f7fffffe          BL       Time_Printf
;;;147                        Alarm_historyBack.power_45V_time[0]=set_time.tm_year-2000;
00019a  488b              LDR      r0,|L2.968|
00019c  7d00              LDRB     r0,[r0,#0x14]  ; set_time
00019e  f5a060fa          SUB      r0,r0,#0x7d0
0001a2  498a              LDR      r1,|L2.972|
0001a4  f881002b          STRB     r0,[r1,#0x2b]
;;;148                        Alarm_historyBack.power_45V_time[1]=set_time.tm_mon;
0001a8  4887              LDR      r0,|L2.968|
0001aa  7c01              LDRB     r1,[r0,#0x10]  ; set_time
0001ac  4887              LDR      r0,|L2.972|
0001ae  f880102c          STRB     r1,[r0,#0x2c]
;;;149                        Alarm_historyBack.power_45V_time[2]=set_time.tm_mday;
0001b2  4885              LDR      r0,|L2.968|
0001b4  7b01              LDRB     r1,[r0,#0xc]  ; set_time
0001b6  4885              LDR      r0,|L2.972|
0001b8  f880102d          STRB     r1,[r0,#0x2d]
;;;150                        Alarm_historyBack.power_45V_time[3]=set_time.tm_hour;
0001bc  4882              LDR      r0,|L2.968|
0001be  7a01              LDRB     r1,[r0,#8]  ; set_time
0001c0  4882              LDR      r0,|L2.972|
0001c2  f880102e          STRB     r1,[r0,#0x2e]
;;;151                        Alarm_historyBack.power_45V_time[4]=set_time.tm_min;
0001c6  4880              LDR      r0,|L2.968|
0001c8  7901              LDRB     r1,[r0,#4]  ; set_time
0001ca  4880              LDR      r0,|L2.972|
0001cc  f880102f          STRB     r1,[r0,#0x2f]
;;;152                        Alarm_historyBack.power_45V_time[5]=set_time.tm_sec;
0001d0  487d              LDR      r0,|L2.968|
0001d2  7801              LDRB     r1,[r0,#0]  ; set_time
0001d4  487d              LDR      r0,|L2.972|
0001d6  f8801030          STRB     r1,[r0,#0x30]
                  |L2.474|
;;;153                    }
;;;154    
;;;155                    Alarm.alarm_history = 1;
0001da  2001              MOVS     r0,#1
0001dc  4977              LDR      r1,|L2.956|
0001de  7008              STRB     r0,[r1,#0]
;;;156                    Alarm.over_Voltage = 1;								
0001e0  7348              STRB     r0,[r1,#0xd]
;;;157                    Alarm_historyBack.power_45V_history[0] = System.Voltage;
0001e2  4875              LDR      r0,|L2.952|
0001e4  6f40              LDR      r0,[r0,#0x74]  ; System
0001e6  4979              LDR      r1,|L2.972|
0001e8  f8c10027          STR      r0,[r1,#0x27]  ; Alarm_historyBack
;;;158    								Trans_printf(" 过压报警1！");
0001ec  a07e              ADR      r0,|L2.1000|
0001ee  f7fffffe          BL       Trans_printf
                  |L2.498|
0001f2  e0de              B        |L2.946|
                  |L2.500|
;;;159                }
;;;160            }
;;;161            else	if( System.Voltage <= Alarm_threshold.Low_45V_limit[0] )			//电压报警(欠压)
0001f4  4a72              LDR      r2,|L2.960|
0001f6  6991              LDR      r1,[r2,#0x18]  ; Alarm_threshold
0001f8  4a6f              LDR      r2,|L2.952|
0001fa  6f50              LDR      r0,[r2,#0x74]  ; System
0001fc  f7fffffe          BL       __aeabi_cfcmple
000200  d8f7              BHI      |L2.498|
;;;162            {
;;;163    			if( Alarm.no_respond == 0x01 )		//新机器设备无响应时，不报欠压报警
000202  486e              LDR      r0,|L2.956|
000204  78c0              LDRB     r0,[r0,#3]  ; Alarm
000206  2801              CMP      r0,#1
000208  d0f3              BEQ      |L2.498|
;;;164    			{
;;;165    				
;;;166    			}
;;;167    			else
;;;168    	
;;;169    				if( Alarm.low_Voltage == 0 )
00020a  486c              LDR      r0,|L2.956|
00020c  7bc0              LDRB     r0,[r0,#0xf]  ; Alarm
00020e  2800              CMP      r0,#0
000210  d1ef              BNE      |L2.498|
;;;170    				{
;;;171    					if( System.time_update_flag == 0x01 )
000212  4869              LDR      r0,|L2.952|
000214  7a80              LDRB     r0,[r0,#0xa]  ; System
000216  2801              CMP      r0,#1
000218  d12a              BNE      |L2.624|
;;;172    					{
;;;173    						Alarm.low_Voltage_time_flag = 0x01;
00021a  4968              LDR      r1,|L2.956|
00021c  7408              STRB     r0,[r1,#0x10]
;;;174    						Time_Printf( (RTC_GetCounter()+g_stamp_distance), &set_time );
00021e  f7fffffe          BL       RTC_GetCounter
000222  4968              LDR      r1,|L2.964|
000224  6809              LDR      r1,[r1,#0]  ; g_stamp_distance
000226  1844              ADDS     r4,r0,r1
000228  4967              LDR      r1,|L2.968|
00022a  4620              MOV      r0,r4
00022c  f7fffffe          BL       Time_Printf
;;;175    						Alarm_historyBack.power_45V_time[0]=set_time.tm_year-2000;
000230  4865              LDR      r0,|L2.968|
000232  7d00              LDRB     r0,[r0,#0x14]  ; set_time
000234  f5a060fa          SUB      r0,r0,#0x7d0
000238  4964              LDR      r1,|L2.972|
00023a  f881002b          STRB     r0,[r1,#0x2b]
;;;176    						Alarm_historyBack.power_45V_time[1]=set_time.tm_mon;
00023e  4862              LDR      r0,|L2.968|
000240  7c01              LDRB     r1,[r0,#0x10]  ; set_time
000242  4862              LDR      r0,|L2.972|
000244  f880102c          STRB     r1,[r0,#0x2c]
;;;177    						Alarm_historyBack.power_45V_time[2]=set_time.tm_mday;
000248  485f              LDR      r0,|L2.968|
00024a  7b01              LDRB     r1,[r0,#0xc]  ; set_time
00024c  485f              LDR      r0,|L2.972|
00024e  f880102d          STRB     r1,[r0,#0x2d]
;;;178    						Alarm_historyBack.power_45V_time[3]=set_time.tm_hour;
000252  485d              LDR      r0,|L2.968|
000254  7a01              LDRB     r1,[r0,#8]  ; set_time
000256  485d              LDR      r0,|L2.972|
000258  f880102e          STRB     r1,[r0,#0x2e]
;;;179    						Alarm_historyBack.power_45V_time[4]=set_time.tm_min;
00025c  485a              LDR      r0,|L2.968|
00025e  7901              LDRB     r1,[r0,#4]  ; set_time
000260  485a              LDR      r0,|L2.972|
000262  f880102f          STRB     r1,[r0,#0x2f]
;;;180    						Alarm_historyBack.power_45V_time[5]=set_time.tm_sec;
000266  4858              LDR      r0,|L2.968|
000268  7801              LDRB     r1,[r0,#0]  ; set_time
00026a  4858              LDR      r0,|L2.972|
00026c  f8801030          STRB     r1,[r0,#0x30]
                  |L2.624|
;;;181    					}
;;;182    
;;;183    					Alarm.alarm_history = 1;
000270  2001              MOVS     r0,#1
000272  4952              LDR      r1,|L2.956|
000274  7008              STRB     r0,[r1,#0]
;;;184    					Alarm.low_Voltage = 1;
000276  73c8              STRB     r0,[r1,#0xf]
;;;185    					Alarm_historyBack.power_45V_history[0] = System.Voltage;
000278  484f              LDR      r0,|L2.952|
00027a  6f40              LDR      r0,[r0,#0x74]  ; System
00027c  4953              LDR      r1,|L2.972|
00027e  f8c10027          STR      r0,[r1,#0x27]  ; Alarm_historyBack
;;;186    					Trans_printf(" 欠压报警1！");
000282  a05d              ADR      r0,|L2.1016|
000284  f7fffffe          BL       Trans_printf
000288  e093              B        |L2.946|
                  |L2.650|
;;;187    				}
;;;188            }
;;;189        }
;;;190        else	if( (System.open==0x02) && (System.close!=1) )		//已经开机，并且不是正在关机才检测电压报警
00028a  484b              LDR      r0,|L2.952|
00028c  7b00              LDRB     r0,[r0,#0xc]  ; System
00028e  2802              CMP      r0,#2
000290  d1af              BNE      |L2.498|
000292  4849              LDR      r0,|L2.952|
000294  7b40              LDRB     r0,[r0,#0xd]  ; System
000296  2801              CMP      r0,#1
000298  d0ab              BEQ      |L2.498|
;;;191        {
;;;192            if( System.Voltage >= Alarm_threshold.Upp_45V_limit[0] )					//电压报警(过压)
00029a  4a49              LDR      r2,|L2.960|
00029c  69d1              LDR      r1,[r2,#0x1c]  ; Alarm_threshold
00029e  4a46              LDR      r2,|L2.952|
0002a0  6f50              LDR      r0,[r2,#0x74]  ; System
0002a2  f7fffffe          BL       __aeabi_cfrcmple
0002a6  d83f              BHI      |L2.808|
;;;193            {
;;;194                if( Alarm.over_Voltage == 0 )
0002a8  4844              LDR      r0,|L2.956|
0002aa  7b40              LDRB     r0,[r0,#0xd]  ; Alarm
0002ac  2800              CMP      r0,#0
0002ae  d1a0              BNE      |L2.498|
;;;195                {
;;;196                    if( System.time_update_flag == 0x01 )
0002b0  4841              LDR      r0,|L2.952|
0002b2  7a80              LDRB     r0,[r0,#0xa]  ; System
0002b4  2801              CMP      r0,#1
0002b6  d12a              BNE      |L2.782|
;;;197                    {
;;;198                        Alarm.over_Voltage_time_flag = 0x01;
0002b8  4940              LDR      r1,|L2.956|
0002ba  7388              STRB     r0,[r1,#0xe]
;;;199                        Time_Printf( (RTC_GetCounter()+g_stamp_distance), &set_time );
0002bc  f7fffffe          BL       RTC_GetCounter
0002c0  4940              LDR      r1,|L2.964|
0002c2  6809              LDR      r1,[r1,#0]  ; g_stamp_distance
0002c4  1844              ADDS     r4,r0,r1
0002c6  4940              LDR      r1,|L2.968|
0002c8  4620              MOV      r0,r4
0002ca  f7fffffe          BL       Time_Printf
;;;200                        Alarm_historyBack.power_45V_time[0]=set_time.tm_year-2000;
0002ce  483e              LDR      r0,|L2.968|
0002d0  7d00              LDRB     r0,[r0,#0x14]  ; set_time
0002d2  f5a060fa          SUB      r0,r0,#0x7d0
0002d6  493d              LDR      r1,|L2.972|
0002d8  f881002b          STRB     r0,[r1,#0x2b]
;;;201                        Alarm_historyBack.power_45V_time[1]=set_time.tm_mon;
0002dc  483a              LDR      r0,|L2.968|
0002de  7c01              LDRB     r1,[r0,#0x10]  ; set_time
0002e0  483a              LDR      r0,|L2.972|
0002e2  f880102c          STRB     r1,[r0,#0x2c]
;;;202                        Alarm_historyBack.power_45V_time[2]=set_time.tm_mday;
0002e6  4838              LDR      r0,|L2.968|
0002e8  7b01              LDRB     r1,[r0,#0xc]  ; set_time
0002ea  4838              LDR      r0,|L2.972|
0002ec  f880102d          STRB     r1,[r0,#0x2d]
;;;203                        Alarm_historyBack.power_45V_time[3]=set_time.tm_hour;
0002f0  4835              LDR      r0,|L2.968|
0002f2  7a01              LDRB     r1,[r0,#8]  ; set_time
0002f4  4835              LDR      r0,|L2.972|
0002f6  f880102e          STRB     r1,[r0,#0x2e]
;;;204                        Alarm_historyBack.power_45V_time[4]=set_time.tm_min;
0002fa  4833              LDR      r0,|L2.968|
0002fc  7901              LDRB     r1,[r0,#4]  ; set_time
0002fe  4833              LDR      r0,|L2.972|
000300  f880102f          STRB     r1,[r0,#0x2f]
;;;205                        Alarm_historyBack.power_45V_time[5]=set_time.tm_sec;
000304  4830              LDR      r0,|L2.968|
000306  7801              LDRB     r1,[r0,#0]  ; set_time
000308  4830              LDR      r0,|L2.972|
00030a  f8801030          STRB     r1,[r0,#0x30]
                  |L2.782|
;;;206                    }
;;;207    
;;;208                    Alarm.alarm_history = 1;
00030e  2001              MOVS     r0,#1
000310  492a              LDR      r1,|L2.956|
000312  7008              STRB     r0,[r1,#0]
;;;209                    Alarm.over_Voltage = 1;
000314  7348              STRB     r0,[r1,#0xd]
;;;210                    Alarm_historyBack.power_45V_history[0] = System.Voltage;
000316  4828              LDR      r0,|L2.952|
000318  6f40              LDR      r0,[r0,#0x74]  ; System
00031a  492c              LDR      r1,|L2.972|
00031c  f8c10027          STR      r0,[r1,#0x27]  ; Alarm_historyBack
;;;211    								Trans_printf(" 过压报警2！");
000320  a039              ADR      r0,|L2.1032|
000322  f7fffffe          BL       Trans_printf
000326  e044              B        |L2.946|
                  |L2.808|
;;;212                }
;;;213            }
;;;214            else	if( System.Voltage <= Alarm_threshold.Low_45V_limit[0] )			//电压报警(欠压)
000328  4a25              LDR      r2,|L2.960|
00032a  6991              LDR      r1,[r2,#0x18]  ; Alarm_threshold
00032c  4a22              LDR      r2,|L2.952|
00032e  6f50              LDR      r0,[r2,#0x74]  ; System
000330  f7fffffe          BL       __aeabi_cfcmple
000334  d83d              BHI      |L2.946|
;;;215            {
;;;216                if( Alarm.low_Voltage == 0 )
000336  4821              LDR      r0,|L2.956|
000338  7bc0              LDRB     r0,[r0,#0xf]  ; Alarm
00033a  bbd0              CBNZ     r0,|L2.946|
;;;217                {
;;;218                    if( System.time_update_flag == 0x01 )
00033c  481e              LDR      r0,|L2.952|
00033e  7a80              LDRB     r0,[r0,#0xa]  ; System
000340  2801              CMP      r0,#1
000342  d12a              BNE      |L2.922|
;;;219                    {
;;;220                        Alarm.low_Voltage_time_flag = 0x01;
000344  491d              LDR      r1,|L2.956|
000346  7408              STRB     r0,[r1,#0x10]
;;;221                        Time_Printf( (RTC_GetCounter()+g_stamp_distance), &set_time );
000348  f7fffffe          BL       RTC_GetCounter
00034c  491d              LDR      r1,|L2.964|
00034e  6809              LDR      r1,[r1,#0]  ; g_stamp_distance
000350  1844              ADDS     r4,r0,r1
000352  491d              LDR      r1,|L2.968|
000354  4620              MOV      r0,r4
000356  f7fffffe          BL       Time_Printf
;;;222                        Alarm_historyBack.power_45V_time[0]=set_time.tm_year-2000;
00035a  481b              LDR      r0,|L2.968|
00035c  7d00              LDRB     r0,[r0,#0x14]  ; set_time
00035e  f5a060fa          SUB      r0,r0,#0x7d0
000362  491a              LDR      r1,|L2.972|
000364  f881002b          STRB     r0,[r1,#0x2b]
;;;223                        Alarm_historyBack.power_45V_time[1]=set_time.tm_mon;
000368  4817              LDR      r0,|L2.968|
00036a  7c01              LDRB     r1,[r0,#0x10]  ; set_time
00036c  4817              LDR      r0,|L2.972|
00036e  f880102c          STRB     r1,[r0,#0x2c]
;;;224                        Alarm_historyBack.power_45V_time[2]=set_time.tm_mday;
000372  4815              LDR      r0,|L2.968|
000374  7b01              LDRB     r1,[r0,#0xc]  ; set_time
000376  4815              LDR      r0,|L2.972|
000378  f880102d          STRB     r1,[r0,#0x2d]
;;;225                        Alarm_historyBack.power_45V_time[3]=set_time.tm_hour;
00037c  4812              LDR      r0,|L2.968|
00037e  7a01              LDRB     r1,[r0,#8]  ; set_time
000380  4812              LDR      r0,|L2.972|
000382  f880102e          STRB     r1,[r0,#0x2e]
;;;226                        Alarm_historyBack.power_45V_time[4]=set_time.tm_min;
000386  4810              LDR      r0,|L2.968|
000388  7901              LDRB     r1,[r0,#4]  ; set_time
00038a  4810              LDR      r0,|L2.972|
00038c  f880102f          STRB     r1,[r0,#0x2f]
;;;227                        Alarm_historyBack.power_45V_time[5]=set_time.tm_sec;
000390  480d              LDR      r0,|L2.968|
000392  7801              LDRB     r1,[r0,#0]  ; set_time
000394  480d              LDR      r0,|L2.972|
000396  f8801030          STRB     r1,[r0,#0x30]
                  |L2.922|
;;;228                    }
;;;229    
;;;230                    Alarm.alarm_history = 1;
00039a  2001              MOVS     r0,#1
00039c  4907              LDR      r1,|L2.956|
00039e  7008              STRB     r0,[r1,#0]
;;;231                    Alarm.low_Voltage = 1;
0003a0  73c8              STRB     r0,[r1,#0xf]
;;;232                    Alarm_historyBack.power_45V_history[0] = System.Voltage;
0003a2  4805              LDR      r0,|L2.952|
0003a4  6f40              LDR      r0,[r0,#0x74]  ; System
0003a6  4909              LDR      r1,|L2.972|
0003a8  f8c10027          STR      r0,[r1,#0x27]  ; Alarm_historyBack
;;;233    								Trans_printf(" 欠压报警2！");
0003ac  a01a              ADR      r0,|L2.1048|
0003ae  f7fffffe          BL       Trans_printf
                  |L2.946|
;;;234                }
;;;235    
;;;236            }
;;;237    				
;;;238        }
;;;239    }
0003b2  e8bd87f0          POP      {r4-r10,pc}
;;;240    
                          ENDP

0003b6  0000              DCW      0x0000
                  |L2.952|
                          DCD      System
                  |L2.956|
                          DCD      Alarm
                  |L2.960|
                          DCD      Alarm_threshold
                  |L2.964|
                          DCD      g_stamp_distance
                  |L2.968|
                          DCD      set_time
                  |L2.972|
                          DCD      Alarm_historyBack
                  |L2.976|
                          DCD      0x3fee6666
                  |L2.980|
                          DCD      0x43fa0000
                  |L2.984|
                          DCD      Sub_Power
                  |L2.988|
                          DCD      xHandleTask_MT2000
                  |L2.992|
                          DCD      0xa3d70a3d
                  |L2.996|
                          DCD      0x40023d70
                  |L2.1000|
0003e8  20b9fdd1          DCB      " ",185,253,209,185,177,168,190,175,"1",163,161,0
0003ec  b9b1a8be
0003f0  af31a3a1
0003f4  00      
0003f5  00                DCB      0
0003f6  00                DCB      0
0003f7  00                DCB      0
                  |L2.1016|
0003f8  20c7b7d1          DCB      " ",199,183,209,185,177,168,190,175,"1",163,161,0
0003fc  b9b1a8be
000400  af31a3a1
000404  00      
000405  00                DCB      0
000406  00                DCB      0
000407  00                DCB      0
                  |L2.1032|
000408  20b9fdd1          DCB      " ",185,253,209,185,177,168,190,175,"2",163,161,0
00040c  b9b1a8be
000410  af32a3a1
000414  00      
000415  00                DCB      0
000416  00                DCB      0
000417  00                DCB      0
                  |L2.1048|
000418  20c7b7d1          DCB      " ",199,183,209,185,177,168,190,175,"2",163,161,0
00041c  b9b1a8be
000420  af32a3a1
000424  00      
000425  00                DCB      0
000426  00                DCB      0
000427  00                DCB      0

                          AREA ||i.alarm_printf||, CODE, READONLY, ALIGN=2

                  alarm_printf PROC
;;;364    /* 打印报警信息 */
;;;365    void alarm_printf(void)
000000  b53e              PUSH     {r1-r5,lr}
;;;366    {
;;;367        if( Alarm.alarm_history == 1 )			//历史报警标志
000002  48f4              LDR      r0,|L3.980|
000004  7800              LDRB     r0,[r0,#0]  ; Alarm
000006  2801              CMP      r0,#1
000008  d17e              BNE      |L3.264|
;;;368        {
;;;369            if( Alarm.emission == 1 )			//发射机自身报警
00000a  48f2              LDR      r0,|L3.980|
00000c  7840              LDRB     r0,[r0,#1]  ; Alarm
00000e  2801              CMP      r0,#1
000010  d14b              BNE      |L3.170|
;;;370            {
;;;371                if( Alarm.emission_time_flag == 0x01 )
000012  48f0              LDR      r0,|L3.980|
000014  7880              LDRB     r0,[r0,#2]  ; Alarm
000016  2801              CMP      r0,#1
000018  d115              BNE      |L3.70|
;;;372                {
;;;373                    App_printf("\r\n20%d-%d-%d	%0.2d:%0.2d:%0.2d\r\n",
00001a  48ef              LDR      r0,|L3.984|
00001c  f890103c          LDRB     r1,[r0,#0x3c]
000020  f890003b          LDRB     r0,[r0,#0x3b]
000024  4aec              LDR      r2,|L3.984|
000026  f892203a          LDRB     r2,[r2,#0x3a]
00002a  e9cd2000          STRD     r2,r0,[sp,#0]
00002e  9102              STR      r1,[sp,#8]
000030  48e9              LDR      r0,|L3.984|
000032  f8903039          LDRB     r3,[r0,#0x39]
000036  f8902038          LDRB     r2,[r0,#0x38]
00003a  f8901037          LDRB     r1,[r0,#0x37]  ; Alarm_historyBack
00003e  a0e7              ADR      r0,|L3.988|
000040  f7fffffe          BL       App_printf
000044  e02e              B        |L3.164|
                  |L3.70|
;;;374                               Alarm_historyBack.emission_time[0],
;;;375                               Alarm_historyBack.emission_time[1],
;;;376                               Alarm_historyBack.emission_time[2],
;;;377                               Alarm_historyBack.emission_time[3],
;;;378                               Alarm_historyBack.emission_time[4],
;;;379                               Alarm_historyBack.emission_time[5]);
;;;380                }
;;;381                else	if( System.time_update_flag == 0x01 )
000046  48ee              LDR      r0,|L3.1024|
000048  7a80              LDRB     r0,[r0,#0xa]  ; System
00004a  2801              CMP      r0,#1
00004c  d12a              BNE      |L3.164|
;;;382                {
;;;383                    Alarm.emission_time_flag = 0x01;
00004e  49e1              LDR      r1,|L3.980|
000050  7088              STRB     r0,[r1,#2]
;;;384                    Time_Printf( (RTC_GetCounter()+g_stamp_distance), &set_time );
000052  f7fffffe          BL       RTC_GetCounter
000056  49eb              LDR      r1,|L3.1028|
000058  6809              LDR      r1,[r1,#0]  ; g_stamp_distance
00005a  1844              ADDS     r4,r0,r1
00005c  49ea              LDR      r1,|L3.1032|
00005e  4620              MOV      r0,r4
000060  f7fffffe          BL       Time_Printf
;;;385                    Alarm_historyBack.emission_time[0]=set_time.tm_year-2000;
000064  48e8              LDR      r0,|L3.1032|
000066  7d00              LDRB     r0,[r0,#0x14]  ; set_time
000068  f5a060fa          SUB      r0,r0,#0x7d0
00006c  49da              LDR      r1,|L3.984|
00006e  f8810037          STRB     r0,[r1,#0x37]
;;;386                    Alarm_historyBack.emission_time[1]=set_time.tm_mon;
000072  48e5              LDR      r0,|L3.1032|
000074  7c01              LDRB     r1,[r0,#0x10]  ; set_time
000076  48d8              LDR      r0,|L3.984|
000078  f8801038          STRB     r1,[r0,#0x38]
;;;387                    Alarm_historyBack.emission_time[2]=set_time.tm_mday;
00007c  48e2              LDR      r0,|L3.1032|
00007e  7b01              LDRB     r1,[r0,#0xc]  ; set_time
000080  48d5              LDR      r0,|L3.984|
000082  f8801039          STRB     r1,[r0,#0x39]
;;;388                    Alarm_historyBack.emission_time[3]=set_time.tm_hour;
000086  48e0              LDR      r0,|L3.1032|
000088  7a01              LDRB     r1,[r0,#8]  ; set_time
00008a  48d3              LDR      r0,|L3.984|
00008c  f880103a          STRB     r1,[r0,#0x3a]
;;;389                    Alarm_historyBack.emission_time[4]=set_time.tm_min;
000090  48dd              LDR      r0,|L3.1032|
000092  7901              LDRB     r1,[r0,#4]  ; set_time
000094  48d0              LDR      r0,|L3.984|
000096  f880103b          STRB     r1,[r0,#0x3b]
;;;390                    Alarm_historyBack.emission_time[5]=set_time.tm_sec;
00009a  48db              LDR      r0,|L3.1032|
00009c  7801              LDRB     r1,[r0,#0]  ; set_time
00009e  48ce              LDR      r0,|L3.984|
0000a0  f880103c          STRB     r1,[r0,#0x3c]
                  |L3.164|
;;;391                }
;;;392    
;;;393                App_printf("emission alarm alarm alarm!\r\n");
0000a4  a0d9              ADR      r0,|L3.1036|
0000a6  f7fffffe          BL       App_printf
                  |L3.170|
;;;394            }
;;;395    
;;;396            if( Alarm.no_respond == 1 )			//激励器无响应报警
0000aa  48ca              LDR      r0,|L3.980|
0000ac  78c0              LDRB     r0,[r0,#3]  ; Alarm
0000ae  2801              CMP      r0,#1
0000b0  d14d              BNE      |L3.334|
;;;397            {
;;;398                if( Alarm.no_respond_time_flag == 0x01 )
0000b2  48c8              LDR      r0,|L3.980|
0000b4  7900              LDRB     r0,[r0,#4]  ; Alarm
0000b6  2801              CMP      r0,#1
0000b8  d115              BNE      |L3.230|
;;;399                {
;;;400                    App_printf("\r\n20%d-%d-%d	%0.2d:%0.2d:%0.2d\r\n",
0000ba  48c7              LDR      r0,|L3.984|
0000bc  f8901036          LDRB     r1,[r0,#0x36]
0000c0  f8900035          LDRB     r0,[r0,#0x35]
0000c4  4ac4              LDR      r2,|L3.984|
0000c6  f8922034          LDRB     r2,[r2,#0x34]
0000ca  e9cd2000          STRD     r2,r0,[sp,#0]
0000ce  9102              STR      r1,[sp,#8]
0000d0  48c1              LDR      r0,|L3.984|
0000d2  f8903033          LDRB     r3,[r0,#0x33]
0000d6  f8902032          LDRB     r2,[r0,#0x32]
0000da  f8901031          LDRB     r1,[r0,#0x31]  ; Alarm_historyBack
0000de  a0bf              ADR      r0,|L3.988|
0000e0  f7fffffe          BL       App_printf
0000e4  e030              B        |L3.328|
                  |L3.230|
;;;401                               Alarm_historyBack.no_response_time[0],
;;;402                               Alarm_historyBack.no_response_time[1],
;;;403                               Alarm_historyBack.no_response_time[2],
;;;404                               Alarm_historyBack.no_response_time[3],
;;;405                               Alarm_historyBack.no_response_time[4],
;;;406                               Alarm_historyBack.no_response_time[5]);
;;;407                }
;;;408                else	if( System.time_update_flag == 0x01 )
0000e6  48c6              LDR      r0,|L3.1024|
0000e8  7a80              LDRB     r0,[r0,#0xa]  ; System
0000ea  2801              CMP      r0,#1
0000ec  d12c              BNE      |L3.328|
;;;409                {
;;;410                    Alarm.no_respond_time_flag = 0x01;
0000ee  49b9              LDR      r1,|L3.980|
0000f0  7108              STRB     r0,[r1,#4]
;;;411                    Time_Printf( (RTC_GetCounter()+g_stamp_distance), &set_time );
0000f2  f7fffffe          BL       RTC_GetCounter
0000f6  49c3              LDR      r1,|L3.1028|
0000f8  6809              LDR      r1,[r1,#0]  ; g_stamp_distance
0000fa  1844              ADDS     r4,r0,r1
0000fc  49c2              LDR      r1,|L3.1032|
0000fe  4620              MOV      r0,r4
000100  f7fffffe          BL       Time_Printf
;;;412                    Alarm_historyBack.no_response_time[0]=set_time.tm_year-2000;
000104  48c0              LDR      r0,|L3.1032|
000106  e000              B        |L3.266|
                  |L3.264|
000108  e314              B        |L3.1844|
                  |L3.266|
00010a  7d00              LDRB     r0,[r0,#0x14]  ; set_time
00010c  f5a060fa          SUB      r0,r0,#0x7d0
000110  49b1              LDR      r1,|L3.984|
000112  f8810031          STRB     r0,[r1,#0x31]
;;;413                    Alarm_historyBack.no_response_time[1]=set_time.tm_mon;
000116  48bc              LDR      r0,|L3.1032|
000118  7c01              LDRB     r1,[r0,#0x10]  ; set_time
00011a  48af              LDR      r0,|L3.984|
00011c  f8801032          STRB     r1,[r0,#0x32]
;;;414                    Alarm_historyBack.no_response_time[2]=set_time.tm_mday;
000120  48b9              LDR      r0,|L3.1032|
000122  7b01              LDRB     r1,[r0,#0xc]  ; set_time
000124  48ac              LDR      r0,|L3.984|
000126  f8801033          STRB     r1,[r0,#0x33]
;;;415                    Alarm_historyBack.no_response_time[3]=set_time.tm_hour;
00012a  48b7              LDR      r0,|L3.1032|
00012c  7a01              LDRB     r1,[r0,#8]  ; set_time
00012e  48aa              LDR      r0,|L3.984|
000130  f8801034          STRB     r1,[r0,#0x34]
;;;416                    Alarm_historyBack.no_response_time[4]=set_time.tm_min;
000134  48b4              LDR      r0,|L3.1032|
000136  7901              LDRB     r1,[r0,#4]  ; set_time
000138  48a7              LDR      r0,|L3.984|
00013a  f8801035          STRB     r1,[r0,#0x35]
;;;417                    Alarm_historyBack.no_response_time[5]=set_time.tm_sec;
00013e  48b2              LDR      r0,|L3.1032|
000140  7801              LDRB     r1,[r0,#0]  ; set_time
000142  48a5              LDR      r0,|L3.984|
000144  f8801036          STRB     r1,[r0,#0x36]
                  |L3.328|
;;;418                }
;;;419    
;;;420                App_printf("no_respond alarm alarm alarm!\r\n");
000148  a0b8              ADR      r0,|L3.1068|
00014a  f7fffffe          BL       App_printf
                  |L3.334|
;;;421            }
;;;422    
;;;423            if( Alarm.over_Electric == 1 )		//过流报警
00014e  48a1              LDR      r0,|L3.980|
000150  7ac0              LDRB     r0,[r0,#0xb]  ; Alarm
000152  2801              CMP      r0,#1
000154  d157              BNE      |L3.518|
;;;424            {
;;;425                if( Alarm.over_Electric_time_flag == 0x01 )
000156  489f              LDR      r0,|L3.980|
000158  7b00              LDRB     r0,[r0,#0xc]  ; Alarm
00015a  2801              CMP      r0,#1
00015c  d116              BNE      |L3.396|
;;;426                {
;;;427                    App_printf("\r\n20%d-%d-%d	%0.2d:%0.2d:%0.2d\r\n",
00015e  489e              LDR      r0,|L3.984|
000160  f8900026          LDRB     r0,[r0,#0x26]
000164  499c              LDR      r1,|L3.984|
000166  f8911025          LDRB     r1,[r1,#0x25]
00016a  4a9b              LDR      r2,|L3.984|
00016c  f8922024          LDRB     r2,[r2,#0x24]
000170  e9cd2100          STRD     r2,r1,[sp,#0]
000174  9002              STR      r0,[sp,#8]
000176  4898              LDR      r0,|L3.984|
000178  f8903023          LDRB     r3,[r0,#0x23]
00017c  f8902022          LDRB     r2,[r0,#0x22]
000180  f8901021          LDRB     r1,[r0,#0x21]  ; Alarm_historyBack
000184  a095              ADR      r0,|L3.988|
000186  f7fffffe          BL       App_printf
00018a  e02e              B        |L3.490|
                  |L3.396|
;;;428                               Alarm_historyBack.power_45A_time[0],
;;;429                               Alarm_historyBack.power_45A_time[1],
;;;430                               Alarm_historyBack.power_45A_time[2],
;;;431                               Alarm_historyBack.power_45A_time[3],
;;;432                               Alarm_historyBack.power_45A_time[4],
;;;433                               Alarm_historyBack.power_45A_time[5]);
;;;434                }
;;;435                else	if( System.time_update_flag == 0x01 )
00018c  489c              LDR      r0,|L3.1024|
00018e  7a80              LDRB     r0,[r0,#0xa]  ; System
000190  2801              CMP      r0,#1
000192  d12a              BNE      |L3.490|
;;;436                {
;;;437                    Alarm.over_Electric_time_flag = 0x01;
000194  498f              LDR      r1,|L3.980|
000196  7308              STRB     r0,[r1,#0xc]
;;;438                    Time_Printf( (RTC_GetCounter()+g_stamp_distance), &set_time );
000198  f7fffffe          BL       RTC_GetCounter
00019c  4999              LDR      r1,|L3.1028|
00019e  6809              LDR      r1,[r1,#0]  ; g_stamp_distance
0001a0  1844              ADDS     r4,r0,r1
0001a2  4999              LDR      r1,|L3.1032|
0001a4  4620              MOV      r0,r4
0001a6  f7fffffe          BL       Time_Printf
;;;439                    Alarm_historyBack.power_45A_time[0]=set_time.tm_year-2000;
0001aa  4897              LDR      r0,|L3.1032|
0001ac  7d00              LDRB     r0,[r0,#0x14]  ; set_time
0001ae  f5a060fa          SUB      r0,r0,#0x7d0
0001b2  4989              LDR      r1,|L3.984|
0001b4  f8810021          STRB     r0,[r1,#0x21]
;;;440                    Alarm_historyBack.power_45A_time[1]=set_time.tm_mon;
0001b8  4893              LDR      r0,|L3.1032|
0001ba  7c01              LDRB     r1,[r0,#0x10]  ; set_time
0001bc  4886              LDR      r0,|L3.984|
0001be  f8801022          STRB     r1,[r0,#0x22]
;;;441                    Alarm_historyBack.power_45A_time[2]=set_time.tm_mday;
0001c2  4891              LDR      r0,|L3.1032|
0001c4  7b01              LDRB     r1,[r0,#0xc]  ; set_time
0001c6  4884              LDR      r0,|L3.984|
0001c8  f8801023          STRB     r1,[r0,#0x23]
;;;442                    Alarm_historyBack.power_45A_time[3]=set_time.tm_hour;
0001cc  488e              LDR      r0,|L3.1032|
0001ce  7a01              LDRB     r1,[r0,#8]  ; set_time
0001d0  4881              LDR      r0,|L3.984|
0001d2  f8801024          STRB     r1,[r0,#0x24]
;;;443                    Alarm_historyBack.power_45A_time[4]=set_time.tm_min;
0001d6  488c              LDR      r0,|L3.1032|
0001d8  7901              LDRB     r1,[r0,#4]  ; set_time
0001da  487f              LDR      r0,|L3.984|
0001dc  f8801025          STRB     r1,[r0,#0x25]
;;;444                    Alarm_historyBack.power_45A_time[5]=set_time.tm_sec;
0001e0  4889              LDR      r0,|L3.1032|
0001e2  7801              LDRB     r1,[r0,#0]  ; set_time
0001e4  487c              LDR      r0,|L3.984|
0001e6  f8801026          STRB     r1,[r0,#0x26]
                  |L3.490|
;;;445                }
;;;446    
;;;447                App_printf("Alarm_historyBack.power_45A_history[0] = %f\r\n",	Alarm_historyBack.power_45A_history[0]);
0001ea  497b              LDR      r1,|L3.984|
0001ec  f8d1001d          LDR      r0,[r1,#0x1d]  ; Alarm_historyBack
0001f0  f7fffffe          BL       __aeabi_f2d
0001f4  4604              MOV      r4,r0
0001f6  4622              MOV      r2,r4
0001f8  460b              MOV      r3,r1
0001fa  a094              ADR      r0,|L3.1100|
0001fc  f7fffffe          BL       App_printf
;;;448                App_printf("over_Electric alarm alarm alarm!\r\n");
000200  a09e              ADR      r0,|L3.1148|
000202  f7fffffe          BL       App_printf
                  |L3.518|
;;;449            }
;;;450    
;;;451            if( Alarm.low_Voltage == 1 || Alarm.over_Voltage == 1 )		//欠压/过压报警
000206  4873              LDR      r0,|L3.980|
000208  7bc0              LDRB     r0,[r0,#0xf]  ; Alarm
00020a  2801              CMP      r0,#1
00020c  d003              BEQ      |L3.534|
00020e  4871              LDR      r0,|L3.980|
000210  7b40              LDRB     r0,[r0,#0xd]  ; Alarm
000212  2801              CMP      r0,#1
000214  d17e              BNE      |L3.788|
                  |L3.534|
;;;452            {
;;;453                if( (Alarm.low_Voltage_time_flag == 0x01) || (Alarm.over_Voltage_time_flag == 0x01) )
000216  486f              LDR      r0,|L3.980|
000218  7c00              LDRB     r0,[r0,#0x10]  ; Alarm
00021a  2801              CMP      r0,#1
00021c  d003              BEQ      |L3.550|
00021e  486d              LDR      r0,|L3.980|
000220  7b80              LDRB     r0,[r0,#0xe]  ; Alarm
000222  2801              CMP      r0,#1
000224  d115              BNE      |L3.594|
                  |L3.550|
;;;454                {
;;;455                    App_printf("\r\n20%d-%d-%d	%0.2d:%0.2d:%0.2d\r\n",
000226  486c              LDR      r0,|L3.984|
000228  f8901030          LDRB     r1,[r0,#0x30]
00022c  f890002f          LDRB     r0,[r0,#0x2f]
000230  4a69              LDR      r2,|L3.984|
000232  f892202e          LDRB     r2,[r2,#0x2e]
000236  e9cd2000          STRD     r2,r0,[sp,#0]
00023a  9102              STR      r1,[sp,#8]
00023c  4866              LDR      r0,|L3.984|
00023e  f890302d          LDRB     r3,[r0,#0x2d]
000242  f890202c          LDRB     r2,[r0,#0x2c]
000246  f890102b          LDRB     r1,[r0,#0x2b]  ; Alarm_historyBack
00024a  a064              ADR      r0,|L3.988|
00024c  f7fffffe          BL       App_printf
000250  e02e              B        |L3.688|
                  |L3.594|
;;;456                               Alarm_historyBack.power_45V_time[0],
;;;457                               Alarm_historyBack.power_45V_time[1],
;;;458                               Alarm_historyBack.power_45V_time[2],
;;;459                               Alarm_historyBack.power_45V_time[3],
;;;460                               Alarm_historyBack.power_45V_time[4],
;;;461                               Alarm_historyBack.power_45V_time[5]);
;;;462                }
;;;463                else	if( System.time_update_flag == 0x01 )
000252  486b              LDR      r0,|L3.1024|
000254  7a80              LDRB     r0,[r0,#0xa]  ; System
000256  2801              CMP      r0,#1
000258  d12a              BNE      |L3.688|
;;;464                {
;;;465                    Alarm.over_Voltage_time_flag = 0x01;
00025a  495e              LDR      r1,|L3.980|
00025c  7388              STRB     r0,[r1,#0xe]
;;;466                    Time_Printf( (RTC_GetCounter()+g_stamp_distance), &set_time );
00025e  f7fffffe          BL       RTC_GetCounter
000262  4968              LDR      r1,|L3.1028|
000264  6809              LDR      r1,[r1,#0]  ; g_stamp_distance
000266  1844              ADDS     r4,r0,r1
000268  4967              LDR      r1,|L3.1032|
00026a  4620              MOV      r0,r4
00026c  f7fffffe          BL       Time_Printf
;;;467                    Alarm_historyBack.power_45V_time[0]=set_time.tm_year-2000;
000270  4865              LDR      r0,|L3.1032|
000272  7d00              LDRB     r0,[r0,#0x14]  ; set_time
000274  f5a060fa          SUB      r0,r0,#0x7d0
000278  4957              LDR      r1,|L3.984|
00027a  f881002b          STRB     r0,[r1,#0x2b]
;;;468                    Alarm_historyBack.power_45V_time[1]=set_time.tm_mon;
00027e  4862              LDR      r0,|L3.1032|
000280  7c01              LDRB     r1,[r0,#0x10]  ; set_time
000282  4855              LDR      r0,|L3.984|
000284  f880102c          STRB     r1,[r0,#0x2c]
;;;469                    Alarm_historyBack.power_45V_time[2]=set_time.tm_mday;
000288  485f              LDR      r0,|L3.1032|
00028a  7b01              LDRB     r1,[r0,#0xc]  ; set_time
00028c  4852              LDR      r0,|L3.984|
00028e  f880102d          STRB     r1,[r0,#0x2d]
;;;470                    Alarm_historyBack.power_45V_time[3]=set_time.tm_hour;
000292  485d              LDR      r0,|L3.1032|
000294  7a01              LDRB     r1,[r0,#8]  ; set_time
000296  4850              LDR      r0,|L3.984|
000298  f880102e          STRB     r1,[r0,#0x2e]
;;;471                    Alarm_historyBack.power_45V_time[4]=set_time.tm_min;
00029c  485a              LDR      r0,|L3.1032|
00029e  7901              LDRB     r1,[r0,#4]  ; set_time
0002a0  484d              LDR      r0,|L3.984|
0002a2  f880102f          STRB     r1,[r0,#0x2f]
;;;472                    Alarm_historyBack.power_45V_time[5]=set_time.tm_sec;
0002a6  4858              LDR      r0,|L3.1032|
0002a8  7801              LDRB     r1,[r0,#0]  ; set_time
0002aa  484b              LDR      r0,|L3.984|
0002ac  f8801030          STRB     r1,[r0,#0x30]
                  |L3.688|
;;;473                }
;;;474    
;;;475                if( Alarm.low_Voltage == 1 )
0002b0  4848              LDR      r0,|L3.980|
0002b2  7bc0              LDRB     r0,[r0,#0xf]  ; Alarm
0002b4  2801              CMP      r0,#1
0002b6  d117              BNE      |L3.744|
;;;476                {
;;;477                    App_printf("Alarm_threshold.Low_45V_limit[0] = %f\r\n", Alarm_threshold.Low_45V_limit[0]);
0002b8  4979              LDR      r1,|L3.1184|
0002ba  6988              LDR      r0,[r1,#0x18]  ; Alarm_threshold
0002bc  f7fffffe          BL       __aeabi_f2d
0002c0  4604              MOV      r4,r0
0002c2  4622              MOV      r2,r4
0002c4  460b              MOV      r3,r1
0002c6  a077              ADR      r0,|L3.1188|
0002c8  f7fffffe          BL       App_printf
;;;478                    App_printf("Alarm_historyBack.power_45V_history = %f\r\n", Alarm_historyBack.power_45V_history[0]);
0002cc  4942              LDR      r1,|L3.984|
0002ce  f8d10027          LDR      r0,[r1,#0x27]  ; Alarm_historyBack
0002d2  f7fffffe          BL       __aeabi_f2d
0002d6  4604              MOV      r4,r0
0002d8  4622              MOV      r2,r4
0002da  460b              MOV      r3,r1
0002dc  a07b              ADR      r0,|L3.1228|
0002de  f7fffffe          BL       App_printf
;;;479                    App_printf("Alarm.low_Voltage alarm alarm alarm!\r\n");
0002e2  a085              ADR      r0,|L3.1272|
0002e4  f7fffffe          BL       App_printf
                  |L3.744|
;;;480                }
;;;481                if( Alarm.over_Voltage == 1 )
0002e8  483a              LDR      r0,|L3.980|
0002ea  7b40              LDRB     r0,[r0,#0xd]  ; Alarm
0002ec  2801              CMP      r0,#1
0002ee  d119              BNE      |L3.804|
;;;482                {
;;;483                    App_printf("Alarm_threshold.Upp_45V_limit[0] = %f\r\n", Alarm_threshold.Upp_45V_limit[0]);
0002f0  496b              LDR      r1,|L3.1184|
0002f2  69c8              LDR      r0,[r1,#0x1c]  ; Alarm_threshold
0002f4  f7fffffe          BL       __aeabi_f2d
0002f8  4604              MOV      r4,r0
0002fa  4622              MOV      r2,r4
0002fc  460b              MOV      r3,r1
0002fe  a088              ADR      r0,|L3.1312|
000300  f7fffffe          BL       App_printf
;;;484                    App_printf("Alarm_historyBack.power_45V_history = %f\r\n", Alarm_historyBack.power_45V_history[0]);
000304  4934              LDR      r1,|L3.984|
000306  f8d10027          LDR      r0,[r1,#0x27]  ; Alarm_historyBack
00030a  f7fffffe          BL       __aeabi_f2d
00030e  4604              MOV      r4,r0
000310  4622              MOV      r2,r4
000312  e000              B        |L3.790|
                  |L3.788|
000314  e006              B        |L3.804|
                  |L3.790|
000316  460b              MOV      r3,r1
000318  a06c              ADR      r0,|L3.1228|
00031a  f7fffffe          BL       App_printf
;;;485                    App_printf("Alarm.over_Voltage alarm alarm alarm!\r\n");
00031e  a08a              ADR      r0,|L3.1352|
000320  f7fffffe          BL       App_printf
                  |L3.804|
;;;486                }
;;;487            }
;;;488    
;;;489            if( Alarm.swr_alarm == 1 )			//驻波比报警
000324  482b              LDR      r0,|L3.980|
000326  7c40              LDRB     r0,[r0,#0x11]  ; Alarm
000328  2801              CMP      r0,#1
00032a  d151              BNE      |L3.976|
;;;490            {
;;;491                if( Alarm.swr_alarm_time_flag == 0x01 )
00032c  4829              LDR      r0,|L3.980|
00032e  7c80              LDRB     r0,[r0,#0x12]  ; Alarm
000330  2801              CMP      r0,#1
000332  d115              BNE      |L3.864|
;;;492                {
;;;493                    App_printf("\r\n20%d-%d-%d	%0.2d:%0.2d:%0.2d\r\n",
000334  4828              LDR      r0,|L3.984|
000336  f8901046          LDRB     r1,[r0,#0x46]
00033a  f8900045          LDRB     r0,[r0,#0x45]
00033e  4a26              LDR      r2,|L3.984|
000340  f8922044          LDRB     r2,[r2,#0x44]
000344  e9cd2000          STRD     r2,r0,[sp,#0]
000348  9102              STR      r1,[sp,#8]
00034a  4823              LDR      r0,|L3.984|
00034c  f8903043          LDRB     r3,[r0,#0x43]
000350  f8902042          LDRB     r2,[r0,#0x42]
000354  f8901041          LDRB     r1,[r0,#0x41]  ; Alarm_historyBack
000358  a020              ADR      r0,|L3.988|
00035a  f7fffffe          BL       App_printf
00035e  e02e              B        |L3.958|
                  |L3.864|
;;;494                               Alarm_historyBack.swr_time[0],
;;;495                               Alarm_historyBack.swr_time[1],
;;;496                               Alarm_historyBack.swr_time[2],
;;;497                               Alarm_historyBack.swr_time[3],
;;;498                               Alarm_historyBack.swr_time[4],
;;;499                               Alarm_historyBack.swr_time[5]);
;;;500                }
;;;501                else	if( System.time_update_flag == 0x01 )
000360  4827              LDR      r0,|L3.1024|
000362  7a80              LDRB     r0,[r0,#0xa]  ; System
000364  2801              CMP      r0,#1
000366  d12a              BNE      |L3.958|
;;;502                {
;;;503                    Alarm.swr_alarm_time_flag = 0x01;
000368  491a              LDR      r1,|L3.980|
00036a  7488              STRB     r0,[r1,#0x12]
;;;504                    Time_Printf( (RTC_GetCounter()+g_stamp_distance), &set_time );
00036c  f7fffffe          BL       RTC_GetCounter
000370  4924              LDR      r1,|L3.1028|
000372  6809              LDR      r1,[r1,#0]  ; g_stamp_distance
000374  1844              ADDS     r4,r0,r1
000376  4924              LDR      r1,|L3.1032|
000378  4620              MOV      r0,r4
00037a  f7fffffe          BL       Time_Printf
;;;505                    Alarm_historyBack.swr_time[0]=set_time.tm_year-2000;
00037e  4822              LDR      r0,|L3.1032|
000380  7d00              LDRB     r0,[r0,#0x14]  ; set_time
000382  f5a060fa          SUB      r0,r0,#0x7d0
000386  4914              LDR      r1,|L3.984|
000388  f8810041          STRB     r0,[r1,#0x41]
;;;506                    Alarm_historyBack.swr_time[1]=set_time.tm_mon;
00038c  481e              LDR      r0,|L3.1032|
00038e  7c01              LDRB     r1,[r0,#0x10]  ; set_time
000390  4811              LDR      r0,|L3.984|
000392  f8801042          STRB     r1,[r0,#0x42]
;;;507                    Alarm_historyBack.swr_time[2]=set_time.tm_mday;
000396  481c              LDR      r0,|L3.1032|
000398  7b01              LDRB     r1,[r0,#0xc]  ; set_time
00039a  480f              LDR      r0,|L3.984|
00039c  f8801043          STRB     r1,[r0,#0x43]
;;;508                    Alarm_historyBack.swr_time[3]=set_time.tm_hour;
0003a0  4819              LDR      r0,|L3.1032|
0003a2  7a01              LDRB     r1,[r0,#8]  ; set_time
0003a4  480c              LDR      r0,|L3.984|
0003a6  f8801044          STRB     r1,[r0,#0x44]
;;;509                    Alarm_historyBack.swr_time[4]=set_time.tm_min;
0003aa  4817              LDR      r0,|L3.1032|
0003ac  7901              LDRB     r1,[r0,#4]  ; set_time
0003ae  480a              LDR      r0,|L3.984|
0003b0  f8801045          STRB     r1,[r0,#0x45]
;;;510                    Alarm_historyBack.swr_time[5]=set_time.tm_sec;
0003b4  4814              LDR      r0,|L3.1032|
0003b6  7801              LDRB     r1,[r0,#0]  ; set_time
0003b8  4807              LDR      r0,|L3.984|
0003ba  f8801046          STRB     r1,[r0,#0x46]
                  |L3.958|
;;;511                }
;;;512    
;;;513                App_printf("Alarm_historyBack.swr_alarm[0] = %f\r\n", Alarm_historyBack.swr_alarm[0]);
0003be  4906              LDR      r1,|L3.984|
0003c0  f8d1003d          LDR      r0,[r1,#0x3d]  ; Alarm_historyBack
0003c4  f7fffffe          BL       __aeabi_f2d
0003c8  4604              MOV      r4,r0
0003ca  4622              MOV      r2,r4
0003cc  460b              MOV      r3,r1
0003ce  e0cf              B        |L3.1392|
                  |L3.976|
0003d0  e0d4              B        |L3.1404|
0003d2  0000              DCW      0x0000
                  |L3.980|
                          DCD      Alarm
                  |L3.984|
                          DCD      Alarm_historyBack
                  |L3.988|
0003dc  0d0a3230          DCB      "\r\n20%d-%d-%d\t%0.2d:%0.2d:%0.2d\r\n",0
0003e0  25642d25
0003e4  642d2564
0003e8  0925302e
0003ec  32643a25
0003f0  302e3264
0003f4  3a25302e
0003f8  32640d0a
0003fc  00      
0003fd  00                DCB      0
0003fe  00                DCB      0
0003ff  00                DCB      0
                  |L3.1024|
                          DCD      System
                  |L3.1028|
                          DCD      g_stamp_distance
                  |L3.1032|
                          DCD      set_time
                  |L3.1036|
00040c  656d6973          DCB      "emission alarm alarm alarm!\r\n",0
000410  73696f6e
000414  20616c61
000418  726d2061
00041c  6c61726d
000420  20616c61
000424  726d210d
000428  0a00    
00042a  00                DCB      0
00042b  00                DCB      0
                  |L3.1068|
00042c  6e6f5f72          DCB      "no_respond alarm alarm alarm!\r\n",0
000430  6573706f
000434  6e642061
000438  6c61726d
00043c  20616c61
000440  726d2061
000444  6c61726d
000448  210d0a00
                  |L3.1100|
00044c  416c6172          DCB      "Alarm_historyBack.power_45A_history[0] = %f\r\n",0
000450  6d5f6869
000454  73746f72
000458  79426163
00045c  6b2e706f
000460  7765725f
000464  3435415f
000468  68697374
00046c  6f72795b
000470  305d203d
000474  2025660d
000478  0a00    
00047a  00                DCB      0
00047b  00                DCB      0
                  |L3.1148|
00047c  6f766572          DCB      "over_Electric alarm alarm alarm!\r\n",0
000480  5f456c65
000484  63747269
000488  6320616c
00048c  61726d20
000490  616c6172
000494  6d20616c
000498  61726d21
00049c  0d0a00  
00049f  00                DCB      0
                  |L3.1184|
                          DCD      Alarm_threshold
                  |L3.1188|
0004a4  416c6172          DCB      "Alarm_threshold.Low_45V_limit[0] = %f\r\n",0
0004a8  6d5f7468
0004ac  72657368
0004b0  6f6c642e
0004b4  4c6f775f
0004b8  3435565f
0004bc  6c696d69
0004c0  745b305d
0004c4  203d2025
0004c8  660d0a00
                  |L3.1228|
0004cc  416c6172          DCB      "Alarm_historyBack.power_45V_history = %f\r\n",0
0004d0  6d5f6869
0004d4  73746f72
0004d8  79426163
0004dc  6b2e706f
0004e0  7765725f
0004e4  3435565f
0004e8  68697374
0004ec  6f727920
0004f0  3d202566
0004f4  0d0a00  
0004f7  00                DCB      0
                  |L3.1272|
0004f8  416c6172          DCB      "Alarm.low_Voltage alarm alarm alarm!\r\n",0
0004fc  6d2e6c6f
000500  775f566f
000504  6c746167
000508  6520616c
00050c  61726d20
000510  616c6172
000514  6d20616c
000518  61726d21
00051c  0d0a00  
00051f  00                DCB      0
                  |L3.1312|
000520  416c6172          DCB      "Alarm_threshold.Upp_45V_limit[0] = %f\r\n",0
000524  6d5f7468
000528  72657368
00052c  6f6c642e
000530  5570705f
000534  3435565f
000538  6c696d69
00053c  745b305d
000540  203d2025
000544  660d0a00
                  |L3.1352|
000548  416c6172          DCB      "Alarm.over_Voltage alarm alarm alarm!\r\n",0
00054c  6d2e6f76
000550  65725f56
000554  6f6c7461
000558  67652061
00055c  6c61726d
000560  20616c61
000564  726d2061
000568  6c61726d
00056c  210d0a00
                  |L3.1392|
000570  a071              ADR      r0,|L3.1848|
000572  f7fffffe          BL       App_printf
;;;514                App_printf("swr_alarm alarm alarm alarm!\r\n");
000576  a07a              ADR      r0,|L3.1888|
000578  f7fffffe          BL       App_printf
                  |L3.1404|
;;;515            }
;;;516    
;;;517            if( Alarm.no_power == 1 )			//无功率输出报警
00057c  4880              LDR      r0,|L3.1920|
00057e  7cc0              LDRB     r0,[r0,#0x13]  ; Alarm
000580  2801              CMP      r0,#1
000582  d141              BNE      |L3.1544|
;;;518            {
;;;519                if( Alarm.no_power_time_flag == 0x01 )
000584  487e              LDR      r0,|L3.1920|
000586  7d00              LDRB     r0,[r0,#0x14]  ; Alarm
000588  2801              CMP      r0,#1
00058a  d111              BNE      |L3.1456|
;;;520                {
;;;521                    App_printf("\r\n20%d-%d-%d	%0.2d:%0.2d:%0.2d\r\n",
00058c  487d              LDR      r0,|L3.1924|
00058e  7a00              LDRB     r0,[r0,#8]
000590  497c              LDR      r1,|L3.1924|
000592  79c9              LDRB     r1,[r1,#7]
000594  4a7b              LDR      r2,|L3.1924|
000596  7992              LDRB     r2,[r2,#6]
000598  e9cd2100          STRD     r2,r1,[sp,#0]
00059c  9002              STR      r0,[sp,#8]
00059e  4879              LDR      r0,|L3.1924|
0005a0  7943              LDRB     r3,[r0,#5]
0005a2  7902              LDRB     r2,[r0,#4]
0005a4  78c1              LDRB     r1,[r0,#3]  ; Alarm_historyBack
0005a6  f2af10cc          ADR      r0,|L3.988|
0005aa  f7fffffe          BL       App_printf
0005ae  e028              B        |L3.1538|
                  |L3.1456|
;;;522                               Alarm_historyBack.no_power_time[0],
;;;523                               Alarm_historyBack.no_power_time[1],
;;;524                               Alarm_historyBack.no_power_time[2],
;;;525                               Alarm_historyBack.no_power_time[3],
;;;526                               Alarm_historyBack.no_power_time[4],
;;;527                               Alarm_historyBack.no_power_time[5]);
;;;528                }
;;;529                else	if( System.time_update_flag == 0x01 )
0005b0  4875              LDR      r0,|L3.1928|
0005b2  7a80              LDRB     r0,[r0,#0xa]  ; System
0005b4  2801              CMP      r0,#1
0005b6  d124              BNE      |L3.1538|
;;;530                {
;;;531                    Alarm.no_power_time_flag = 0x01;
0005b8  4971              LDR      r1,|L3.1920|
0005ba  7508              STRB     r0,[r1,#0x14]
;;;532                    Time_Printf( (RTC_GetCounter()+g_stamp_distance), &set_time );
0005bc  f7fffffe          BL       RTC_GetCounter
0005c0  4972              LDR      r1,|L3.1932|
0005c2  6809              LDR      r1,[r1,#0]  ; g_stamp_distance
0005c4  1844              ADDS     r4,r0,r1
0005c6  4972              LDR      r1,|L3.1936|
0005c8  4620              MOV      r0,r4
0005ca  f7fffffe          BL       Time_Printf
;;;533                    Alarm_historyBack.no_power_time[0]=set_time.tm_year-2000;
0005ce  4870              LDR      r0,|L3.1936|
0005d0  7d00              LDRB     r0,[r0,#0x14]  ; set_time
0005d2  f5a060fa          SUB      r0,r0,#0x7d0
0005d6  496b              LDR      r1,|L3.1924|
0005d8  70c8              STRB     r0,[r1,#3]
;;;534                    Alarm_historyBack.no_power_time[1]=set_time.tm_mon;
0005da  486d              LDR      r0,|L3.1936|
0005dc  7c01              LDRB     r1,[r0,#0x10]  ; set_time
0005de  4869              LDR      r0,|L3.1924|
0005e0  7101              STRB     r1,[r0,#4]
;;;535                    Alarm_historyBack.no_power_time[2]=set_time.tm_mday;
0005e2  486b              LDR      r0,|L3.1936|
0005e4  7b01              LDRB     r1,[r0,#0xc]  ; set_time
0005e6  4867              LDR      r0,|L3.1924|
0005e8  7141              STRB     r1,[r0,#5]
;;;536                    Alarm_historyBack.no_power_time[3]=set_time.tm_hour;
0005ea  4869              LDR      r0,|L3.1936|
0005ec  7a01              LDRB     r1,[r0,#8]  ; set_time
0005ee  4865              LDR      r0,|L3.1924|
0005f0  7181              STRB     r1,[r0,#6]
;;;537                    Alarm_historyBack.no_power_time[4]=set_time.tm_min;
0005f2  4867              LDR      r0,|L3.1936|
0005f4  7901              LDRB     r1,[r0,#4]  ; set_time
0005f6  4863              LDR      r0,|L3.1924|
0005f8  71c1              STRB     r1,[r0,#7]
;;;538                    Alarm_historyBack.no_power_time[5]=set_time.tm_sec;
0005fa  4865              LDR      r0,|L3.1936|
0005fc  7801              LDRB     r1,[r0,#0]  ; set_time
0005fe  4861              LDR      r0,|L3.1924|
000600  7201              STRB     r1,[r0,#8]
                  |L3.1538|
;;;539                }
;;;540    
;;;541                App_printf("no_power alarm alarm alarm!\r\n");
000602  a064              ADR      r0,|L3.1940|
000604  f7fffffe          BL       App_printf
                  |L3.1544|
;;;542            }
;;;543    
;;;544            if( Alarm.temperature_alarm == 1 )	//温度报警
000608  485d              LDR      r0,|L3.1920|
00060a  79c0              LDRB     r0,[r0,#7]  ; Alarm
00060c  2801              CMP      r0,#1
00060e  d146              BNE      |L3.1694|
;;;545            {
;;;546                if( Alarm.temperature_alarm_time_flag == 0x01 )
000610  485b              LDR      r0,|L3.1920|
000612  7a00              LDRB     r0,[r0,#8]  ; Alarm
000614  2801              CMP      r0,#1
000616  d111              BNE      |L3.1596|
;;;547                {
;;;548                    App_printf("\r\n20%d-%d-%d	%0.2d:%0.2d:%0.2d\r\n",
000618  485a              LDR      r0,|L3.1924|
00061a  7c80              LDRB     r0,[r0,#0x12]
00061c  4959              LDR      r1,|L3.1924|
00061e  7c49              LDRB     r1,[r1,#0x11]
000620  4a58              LDR      r2,|L3.1924|
000622  7c12              LDRB     r2,[r2,#0x10]
000624  e9cd2100          STRD     r2,r1,[sp,#0]
000628  9002              STR      r0,[sp,#8]
00062a  4856              LDR      r0,|L3.1924|
00062c  7bc3              LDRB     r3,[r0,#0xf]
00062e  7b82              LDRB     r2,[r0,#0xe]
000630  7b41              LDRB     r1,[r0,#0xd]  ; Alarm_historyBack
000632  f2af2058          ADR      r0,|L3.988|
000636  f7fffffe          BL       App_printf
00063a  e028              B        |L3.1678|
                  |L3.1596|
;;;549                               Alarm_historyBack.temp_time[0],
;;;550                               Alarm_historyBack.temp_time[1],
;;;551                               Alarm_historyBack.temp_time[2],
;;;552                               Alarm_historyBack.temp_time[3],
;;;553                               Alarm_historyBack.temp_time[4],
;;;554                               Alarm_historyBack.temp_time[5]);
;;;555                }
;;;556                else	if( System.time_update_flag == 0x01 )
00063c  4852              LDR      r0,|L3.1928|
00063e  7a80              LDRB     r0,[r0,#0xa]  ; System
000640  2801              CMP      r0,#1
000642  d124              BNE      |L3.1678|
;;;557                {
;;;558                    Alarm.temperature_alarm_time_flag = 0x01;
000644  494e              LDR      r1,|L3.1920|
000646  7208              STRB     r0,[r1,#8]
;;;559                    Time_Printf( (RTC_GetCounter()+g_stamp_distance), &set_time );
000648  f7fffffe          BL       RTC_GetCounter
00064c  494f              LDR      r1,|L3.1932|
00064e  6809              LDR      r1,[r1,#0]  ; g_stamp_distance
000650  1844              ADDS     r4,r0,r1
000652  494f              LDR      r1,|L3.1936|
000654  4620              MOV      r0,r4
000656  f7fffffe          BL       Time_Printf
;;;560                    Alarm_historyBack.temp_time[0]=set_time.tm_year-2000;
00065a  484d              LDR      r0,|L3.1936|
00065c  7d00              LDRB     r0,[r0,#0x14]  ; set_time
00065e  f5a060fa          SUB      r0,r0,#0x7d0
000662  4948              LDR      r1,|L3.1924|
000664  7348              STRB     r0,[r1,#0xd]
;;;561                    Alarm_historyBack.temp_time[1]=set_time.tm_mon;
000666  484a              LDR      r0,|L3.1936|
000668  7c01              LDRB     r1,[r0,#0x10]  ; set_time
00066a  4846              LDR      r0,|L3.1924|
00066c  7381              STRB     r1,[r0,#0xe]
;;;562                    Alarm_historyBack.temp_time[2]=set_time.tm_mday;
00066e  4848              LDR      r0,|L3.1936|
000670  7b01              LDRB     r1,[r0,#0xc]  ; set_time
000672  4844              LDR      r0,|L3.1924|
000674  73c1              STRB     r1,[r0,#0xf]
;;;563                    Alarm_historyBack.temp_time[3]=set_time.tm_hour;
000676  4846              LDR      r0,|L3.1936|
000678  7a01              LDRB     r1,[r0,#8]  ; set_time
00067a  4842              LDR      r0,|L3.1924|
00067c  7401              STRB     r1,[r0,#0x10]
;;;564                    Alarm_historyBack.temp_time[4]=set_time.tm_min;
00067e  4844              LDR      r0,|L3.1936|
000680  7901              LDRB     r1,[r0,#4]  ; set_time
000682  4840              LDR      r0,|L3.1924|
000684  7441              STRB     r1,[r0,#0x11]
;;;565                    Alarm_historyBack.temp_time[5]=set_time.tm_sec;
000686  4842              LDR      r0,|L3.1936|
000688  7801              LDRB     r1,[r0,#0]  ; set_time
00068a  483e              LDR      r0,|L3.1924|
00068c  7481              STRB     r1,[r0,#0x12]
                  |L3.1678|
;;;566                }
;;;567    
;;;568                App_printf("Temperature=%f C\r\n", Alarm_historyBack.temp_history);
00068e  493d              LDR      r1,|L3.1924|
000690  3109              ADDS     r1,r1,#9
000692  a048              ADR      r0,|L3.1972|
000694  f7fffffe          BL       App_printf
;;;569                App_printf("temperature_alarm alarm alarm alarm!\r\n");
000698  a04b              ADR      r0,|L3.1992|
00069a  f7fffffe          BL       App_printf
                  |L3.1694|
;;;570            }
;;;571    
;;;572            if( Alarm.humidity_alarm == 1 )		//湿度报警
00069e  4838              LDR      r0,|L3.1920|
0006a0  7a40              LDRB     r0,[r0,#9]  ; Alarm
0006a2  2801              CMP      r0,#1
0006a4  d146              BNE      |L3.1844|
;;;573            {
;;;574                if( Alarm.humidity_alarm_time_flag == 0x01 )
0006a6  4836              LDR      r0,|L3.1920|
0006a8  7a80              LDRB     r0,[r0,#0xa]  ; Alarm
0006aa  2801              CMP      r0,#1
0006ac  d111              BNE      |L3.1746|
;;;575                {
;;;576                    App_printf("\r\n20%d-%d-%d	%0.2d:%0.2d:%0.2d\r\n",
0006ae  4835              LDR      r0,|L3.1924|
0006b0  7f00              LDRB     r0,[r0,#0x1c]
0006b2  4934              LDR      r1,|L3.1924|
0006b4  7ec9              LDRB     r1,[r1,#0x1b]
0006b6  4a33              LDR      r2,|L3.1924|
0006b8  7e92              LDRB     r2,[r2,#0x1a]
0006ba  e9cd2100          STRD     r2,r1,[sp,#0]
0006be  9002              STR      r0,[sp,#8]
0006c0  4830              LDR      r0,|L3.1924|
0006c2  7e43              LDRB     r3,[r0,#0x19]
0006c4  7e02              LDRB     r2,[r0,#0x18]
0006c6  7dc1              LDRB     r1,[r0,#0x17]  ; Alarm_historyBack
0006c8  f2af20f0          ADR      r0,|L3.988|
0006cc  f7fffffe          BL       App_printf
0006d0  e028              B        |L3.1828|
                  |L3.1746|
;;;577                               Alarm_historyBack.humidity_time[0],
;;;578                               Alarm_historyBack.humidity_time[1],
;;;579                               Alarm_historyBack.humidity_time[2],
;;;580                               Alarm_historyBack.humidity_time[3],
;;;581                               Alarm_historyBack.humidity_time[4],
;;;582                               Alarm_historyBack.humidity_time[5]);
;;;583                }
;;;584                else	if( System.time_update_flag == 0x01 )
0006d2  482d              LDR      r0,|L3.1928|
0006d4  7a80              LDRB     r0,[r0,#0xa]  ; System
0006d6  2801              CMP      r0,#1
0006d8  d124              BNE      |L3.1828|
;;;585                {
;;;586                    Alarm.humidity_alarm_time_flag = 0x01;
0006da  4929              LDR      r1,|L3.1920|
0006dc  7288              STRB     r0,[r1,#0xa]
;;;587                    Time_Printf( (RTC_GetCounter()+g_stamp_distance), &set_time );
0006de  f7fffffe          BL       RTC_GetCounter
0006e2  492a              LDR      r1,|L3.1932|
0006e4  6809              LDR      r1,[r1,#0]  ; g_stamp_distance
0006e6  1844              ADDS     r4,r0,r1
0006e8  4929              LDR      r1,|L3.1936|
0006ea  4620              MOV      r0,r4
0006ec  f7fffffe          BL       Time_Printf
;;;588                    Alarm_historyBack.humidity_time[0]=set_time.tm_year-2000;
0006f0  4827              LDR      r0,|L3.1936|
0006f2  7d00              LDRB     r0,[r0,#0x14]  ; set_time
0006f4  f5a060fa          SUB      r0,r0,#0x7d0
0006f8  4922              LDR      r1,|L3.1924|
0006fa  75c8              STRB     r0,[r1,#0x17]
;;;589                    Alarm_historyBack.humidity_time[1]=set_time.tm_mon;
0006fc  4824              LDR      r0,|L3.1936|
0006fe  7c01              LDRB     r1,[r0,#0x10]  ; set_time
000700  4820              LDR      r0,|L3.1924|
000702  7601              STRB     r1,[r0,#0x18]
;;;590                    Alarm_historyBack.humidity_time[2]=set_time.tm_mday;
000704  4822              LDR      r0,|L3.1936|
000706  7b01              LDRB     r1,[r0,#0xc]  ; set_time
000708  481e              LDR      r0,|L3.1924|
00070a  7641              STRB     r1,[r0,#0x19]
;;;591                    Alarm_historyBack.humidity_time[3]=set_time.tm_hour;
00070c  4820              LDR      r0,|L3.1936|
00070e  7a01              LDRB     r1,[r0,#8]  ; set_time
000710  481c              LDR      r0,|L3.1924|
000712  7681              STRB     r1,[r0,#0x1a]
;;;592                    Alarm_historyBack.humidity_time[4]=set_time.tm_min;
000714  481e              LDR      r0,|L3.1936|
000716  7901              LDRB     r1,[r0,#4]  ; set_time
000718  481a              LDR      r0,|L3.1924|
00071a  76c1              STRB     r1,[r0,#0x1b]
;;;593                    Alarm_historyBack.humidity_time[5]=set_time.tm_sec;
00071c  481c              LDR      r0,|L3.1936|
00071e  7801              LDRB     r1,[r0,#0]  ; set_time
000720  4818              LDR      r0,|L3.1924|
000722  7701              STRB     r1,[r0,#0x1c]
                  |L3.1828|
;;;594                }
;;;595    
;;;596                App_printf("Humidity=%f%% \r\n", Alarm_historyBack.humidity_history);
000724  4917              LDR      r1,|L3.1924|
000726  3113              ADDS     r1,r1,#0x13
000728  a031              ADR      r0,|L3.2032|
00072a  f7fffffe          BL       App_printf
;;;597                App_printf("humidity_alarm alarm alarm alarm!\r\n");
00072e  a035              ADR      r0,|L3.2052|
000730  f7fffffe          BL       App_printf
                  |L3.1844|
;;;598            }
;;;599        }
;;;600    
;;;601    
;;;602    }
000734  bd3e              POP      {r1-r5,pc}
;;;603    
                          ENDP

000736  0000              DCW      0x0000
                  |L3.1848|
000738  416c6172          DCB      "Alarm_historyBack.swr_alarm[0] = %f\r\n",0
00073c  6d5f6869
000740  73746f72
000744  79426163
000748  6b2e7377
00074c  725f616c
000750  61726d5b
000754  305d203d
000758  2025660d
00075c  0a00    
00075e  00                DCB      0
00075f  00                DCB      0
                  |L3.1888|
000760  7377725f          DCB      "swr_alarm alarm alarm alarm!\r\n",0
000764  616c6172
000768  6d20616c
00076c  61726d20
000770  616c6172
000774  6d20616c
000778  61726d21
00077c  0d0a00  
00077f  00                DCB      0
                  |L3.1920|
                          DCD      Alarm
                  |L3.1924|
                          DCD      Alarm_historyBack
                  |L3.1928|
                          DCD      System
                  |L3.1932|
                          DCD      g_stamp_distance
                  |L3.1936|
                          DCD      set_time
                  |L3.1940|
000794  6e6f5f70          DCB      "no_power alarm alarm alarm!\r\n",0
000798  6f776572
00079c  20616c61
0007a0  726d2061
0007a4  6c61726d
0007a8  20616c61
0007ac  726d210d
0007b0  0a00    
0007b2  00                DCB      0
0007b3  00                DCB      0
                  |L3.1972|
0007b4  54656d70          DCB      "Temperature=%f C\r\n",0
0007b8  65726174
0007bc  7572653d
0007c0  25662043
0007c4  0d0a00  
0007c7  00                DCB      0
                  |L3.1992|
0007c8  74656d70          DCB      "temperature_alarm alarm alarm alarm!\r\n",0
0007cc  65726174
0007d0  7572655f
0007d4  616c6172
0007d8  6d20616c
0007dc  61726d20
0007e0  616c6172
0007e4  6d20616c
0007e8  61726d21
0007ec  0d0a00  
0007ef  00                DCB      0
                  |L3.2032|
0007f0  48756d69          DCB      "Humidity=%f%% \r\n",0
0007f4  64697479
0007f8  3d256625
0007fc  25200d0a
000800  00      
000801  00                DCB      0
000802  00                DCB      0
000803  00                DCB      0
                  |L3.2052|
000804  68756d69          DCB      "humidity_alarm alarm alarm alarm!\r\n",0
000808  64697479
00080c  5f616c61
000810  726d2061
000814  6c61726d
000818  20616c61
00081c  726d2061
000820  6c61726d
000824  210d0a00

                          AREA ||i.clean_all_alarm_flags||, CODE, READONLY, ALIGN=2

                  clean_all_alarm_flags PROC
;;;691    /* 清除所有报警标志位 */
;;;692    void clean_all_alarm_flags(void)
000000  b510              PUSH     {r4,lr}
;;;693    {
;;;694        Alarm.alarm_history=0;		//历史报警标志
000002  2000              MOVS     r0,#0
000004  4908              LDR      r1,|L4.40|
000006  7008              STRB     r0,[r1,#0]
;;;695        Alarm.emission=0;			//发射机自身报警
000008  7048              STRB     r0,[r1,#1]
;;;696        Alarm.no_respond=0;			//激励器无响应报警
00000a  70c8              STRB     r0,[r1,#3]
;;;697    
;;;698        Alarm.over_Electric=0;		//过流报警
00000c  72c8              STRB     r0,[r1,#0xb]
;;;699        Alarm.low_Voltage=0;		//欠压报警
00000e  73c8              STRB     r0,[r1,#0xf]
;;;700        Alarm.over_Voltage=0;		//过压报警
000010  7348              STRB     r0,[r1,#0xd]
;;;701        Alarm.swr_alarm=0;			//驻波比报警
000012  7448              STRB     r0,[r1,#0x11]
;;;702        Alarm.no_power=0;			//无功率输出报警
000014  74c8              STRB     r0,[r1,#0x13]
;;;703    
;;;704        Alarm.temperature_alarm=0;	//温度报警
000016  71c8              STRB     r0,[r1,#7]
;;;705        Alarm.humidity_alarm=0;		//湿度报警
000018  7248              STRB     r0,[r1,#9]
;;;706    		Alarm.power_cataclysm=0;
00001a  7548              STRB     r0,[r1,#0x15]
;;;707        //历史报警包全部数据清零
;;;708        memset(&Alarm_historyBack,0,sizeof(Alarm_historyBack));
00001c  217b              MOVS     r1,#0x7b
00001e  4803              LDR      r0,|L4.44|
000020  f7fffffe          BL       __aeabi_memclr
;;;709    }
000024  bd10              POP      {r4,pc}
;;;710    
                          ENDP

000026  0000              DCW      0x0000
                  |L4.40|
                          DCD      Alarm
                  |L4.44|
                          DCD      Alarm_historyBack

                          AREA ||i.emission_alarm_content_clean||, CODE, READONLY, ALIGN=2

                  emission_alarm_content_clean PROC
;;;767    
;;;768    void emission_alarm_content_clean(void)
000000  2000              MOVS     r0,#0
;;;769    {
;;;770    	uint8_t	i = 0;
;;;771    	
;;;772    	for(i=0; i<40; i++)
000002  bf00              NOP      
000004  e004              B        |L5.16|
                  |L5.6|
;;;773    	{
;;;774    		Alarm_historyBack.emission_alarm_content[i] = 0x00;
000006  2200              MOVS     r2,#0
000008  4903              LDR      r1,|L5.24|
00000a  540a              STRB     r2,[r1,r0]
00000c  1c41              ADDS     r1,r0,#1              ;772
00000e  b2c8              UXTB     r0,r1                 ;772
                  |L5.16|
000010  2828              CMP      r0,#0x28              ;772
000012  dbf8              BLT      |L5.6|
;;;775    	}
;;;776    }
000014  4770              BX       lr
                          ENDP

000016  0000              DCW      0x0000
                  |L5.24|
                          DCD      Alarm_historyBack+0x47

                          AREA ||i.get_history_alarm||, CODE, READONLY, ALIGN=2

                  get_history_alarm PROC
;;;604    /*返回1表示有历史报警消息*/
;;;605    int get_history_alarm(void)
000000  b510              PUSH     {r4,lr}
;;;606    {
;;;607        uint8_t ret = 0;
000002  2400              MOVS     r4,#0
;;;608    //	if( Alarm.alarm_history == 1 )		//历史报警标志
;;;609    //		ret = 1;
;;;610    
;;;611        set_alarm_bit();
000004  f7fffffe          BL       set_alarm_bit
;;;612    
;;;613        if( Alarm.emission == 1 )			//发射机自身报警
000008  4838              LDR      r0,|L6.236|
00000a  7840              LDRB     r0,[r0,#1]  ; Alarm
00000c  2801              CMP      r0,#1
00000e  d107              BNE      |L6.32|
;;;614        {
;;;615            Alarm.alarm_history = 1;
000010  4936              LDR      r1,|L6.236|
000012  7008              STRB     r0,[r1,#0]
;;;616            ret = 1;
000014  2401              MOVS     r4,#1
;;;617    			  Trans_printf(" 发射机自身报警 ！ \n");
000016  a036              ADR      r0,|L6.240|
000018  f7fffffe          BL       Trans_printf
;;;618            return ret;
00001c  4620              MOV      r0,r4
                  |L6.30|
;;;619    			
;;;620        }
;;;621    
;;;622        if( Alarm.no_respond == 1 )			//激励器无响应报警
;;;623        {
;;;624            Alarm.alarm_history = 1;
;;;625            ret = 1;
;;;626    			  Trans_printf(" 激励器无响应报警 ！ \n");
;;;627            return ret;
;;;628        }
;;;629    
;;;630        if( Alarm.over_Electric == 1 )		//过流报警
;;;631        {
;;;632            Alarm.alarm_history = 1;
;;;633            ret = 1;
;;;634    			Trans_printf(" 过流报警 ！ \n");
;;;635            return ret;
;;;636        }
;;;637    
;;;638        if( Alarm.low_Voltage == 1 )		//欠压报警
;;;639        {
;;;640            Alarm.alarm_history = 1;
;;;641            ret = 1;
;;;642    			Trans_printf(" 欠压报警 ！ \n");
;;;643            return ret;
;;;644        }
;;;645    
;;;646        if( Alarm.over_Voltage == 1 )		//过压报警
;;;647        {
;;;648            Alarm.alarm_history = 1;
;;;649            ret = 1;
;;;650    			Trans_printf(" 过压报警 ！ \n");
;;;651            return ret;
;;;652        }
;;;653    
;;;654        if( Alarm.swr_alarm == 1 )			//驻波比报警
;;;655        {
;;;656            Alarm.alarm_history = 1;
;;;657            ret = 1;
;;;658    			Trans_printf(" 驻波比报警 ！ \n");
;;;659            return ret;
;;;660        }
;;;661    
;;;662        if( Alarm.no_power == 1 )			//无功率输出报警
;;;663        {
;;;664            Alarm.alarm_history = 1;
;;;665            ret = 1;
;;;666    			Trans_printf(" 无功率输出报警 ！ \n");
;;;667            return ret;
;;;668        }
;;;669    
;;;670        if( Alarm.temperature_alarm == 1 )	//温度报警
;;;671        {
;;;672            Alarm.alarm_history = 1;
;;;673            ret = 1;
;;;674    			Trans_printf(" 温度报警 ！ \n");
;;;675            return ret;
;;;676        }
;;;677    
;;;678        if( Alarm.humidity_alarm == 1 )		//湿度报警
;;;679        {
;;;680            Alarm.alarm_history = 1;
;;;681            ret = 1;
;;;682    			Trans_printf(" 湿度报警 ！ \n");
;;;683            return ret;
;;;684        }
;;;685    //   Trans_printf(" 无历史报警，返回0！ \n");
;;;686        Alarm.alarm_history = 0;
;;;687        ret = 0;
;;;688        return ret;
;;;689    }
00001e  bd10              POP      {r4,pc}
                  |L6.32|
000020  4832              LDR      r0,|L6.236|
000022  78c0              LDRB     r0,[r0,#3]            ;622  ; Alarm
000024  2801              CMP      r0,#1                 ;622
000026  d107              BNE      |L6.56|
000028  4930              LDR      r1,|L6.236|
00002a  7008              STRB     r0,[r1,#0]            ;624
00002c  2401              MOVS     r4,#1                 ;625
00002e  a036              ADR      r0,|L6.264|
000030  f7fffffe          BL       Trans_printf
000034  4620              MOV      r0,r4                 ;627
000036  e7f2              B        |L6.30|
                  |L6.56|
000038  482c              LDR      r0,|L6.236|
00003a  7ac0              LDRB     r0,[r0,#0xb]          ;630  ; Alarm
00003c  2801              CMP      r0,#1                 ;630
00003e  d107              BNE      |L6.80|
000040  492a              LDR      r1,|L6.236|
000042  7008              STRB     r0,[r1,#0]            ;632
000044  2401              MOVS     r4,#1                 ;633
000046  a036              ADR      r0,|L6.288|
000048  f7fffffe          BL       Trans_printf
00004c  4620              MOV      r0,r4                 ;635
00004e  e7e6              B        |L6.30|
                  |L6.80|
000050  4826              LDR      r0,|L6.236|
000052  7bc0              LDRB     r0,[r0,#0xf]          ;638  ; Alarm
000054  2801              CMP      r0,#1                 ;638
000056  d107              BNE      |L6.104|
000058  4924              LDR      r1,|L6.236|
00005a  7008              STRB     r0,[r1,#0]            ;640
00005c  2401              MOVS     r4,#1                 ;641
00005e  a034              ADR      r0,|L6.304|
000060  f7fffffe          BL       Trans_printf
000064  4620              MOV      r0,r4                 ;643
000066  e7da              B        |L6.30|
                  |L6.104|
000068  4820              LDR      r0,|L6.236|
00006a  7b40              LDRB     r0,[r0,#0xd]          ;646  ; Alarm
00006c  2801              CMP      r0,#1                 ;646
00006e  d107              BNE      |L6.128|
000070  491e              LDR      r1,|L6.236|
000072  7008              STRB     r0,[r1,#0]            ;648
000074  2401              MOVS     r4,#1                 ;649
000076  a032              ADR      r0,|L6.320|
000078  f7fffffe          BL       Trans_printf
00007c  4620              MOV      r0,r4                 ;651
00007e  e7ce              B        |L6.30|
                  |L6.128|
000080  481a              LDR      r0,|L6.236|
000082  7c40              LDRB     r0,[r0,#0x11]         ;654  ; Alarm
000084  2801              CMP      r0,#1                 ;654
000086  d107              BNE      |L6.152|
000088  4918              LDR      r1,|L6.236|
00008a  7008              STRB     r0,[r1,#0]            ;656
00008c  2401              MOVS     r4,#1                 ;657
00008e  a030              ADR      r0,|L6.336|
000090  f7fffffe          BL       Trans_printf
000094  4620              MOV      r0,r4                 ;659
000096  e7c2              B        |L6.30|
                  |L6.152|
000098  4814              LDR      r0,|L6.236|
00009a  7cc0              LDRB     r0,[r0,#0x13]         ;662  ; Alarm
00009c  2801              CMP      r0,#1                 ;662
00009e  d107              BNE      |L6.176|
0000a0  4912              LDR      r1,|L6.236|
0000a2  7008              STRB     r0,[r1,#0]            ;664
0000a4  2401              MOVS     r4,#1                 ;665
0000a6  a02f              ADR      r0,|L6.356|
0000a8  f7fffffe          BL       Trans_printf
0000ac  4620              MOV      r0,r4                 ;667
0000ae  e7b6              B        |L6.30|
                  |L6.176|
0000b0  480e              LDR      r0,|L6.236|
0000b2  79c0              LDRB     r0,[r0,#7]            ;670  ; Alarm
0000b4  2801              CMP      r0,#1                 ;670
0000b6  d107              BNE      |L6.200|
0000b8  490c              LDR      r1,|L6.236|
0000ba  7008              STRB     r0,[r1,#0]            ;672
0000bc  2401              MOVS     r4,#1                 ;673
0000be  a02f              ADR      r0,|L6.380|
0000c0  f7fffffe          BL       Trans_printf
0000c4  4620              MOV      r0,r4                 ;675
0000c6  e7aa              B        |L6.30|
                  |L6.200|
0000c8  4808              LDR      r0,|L6.236|
0000ca  7a40              LDRB     r0,[r0,#9]            ;678  ; Alarm
0000cc  2801              CMP      r0,#1                 ;678
0000ce  d107              BNE      |L6.224|
0000d0  4906              LDR      r1,|L6.236|
0000d2  7008              STRB     r0,[r1,#0]            ;680
0000d4  2401              MOVS     r4,#1                 ;681
0000d6  a02d              ADR      r0,|L6.396|
0000d8  f7fffffe          BL       Trans_printf
0000dc  4620              MOV      r0,r4                 ;683
0000de  e79e              B        |L6.30|
                  |L6.224|
0000e0  2000              MOVS     r0,#0                 ;686
0000e2  4902              LDR      r1,|L6.236|
0000e4  7008              STRB     r0,[r1,#0]            ;686
0000e6  2400              MOVS     r4,#0                 ;687
0000e8  4620              MOV      r0,r4                 ;688
0000ea  e798              B        |L6.30|
;;;690    
                          ENDP

                  |L6.236|
                          DCD      Alarm
                  |L6.240|
0000f0  20b7a2c9          DCB      " ",183,162,201,228,187,250,215,212,201,237,177,168,190,175
0000f4  e4bbfad7
0000f8  d4c9edb1
0000fc  a8beaf  
0000ff  20a3a120          DCB      " ",163,161," \n",0
000103  0a00    
000105  00                DCB      0
000106  00                DCB      0
000107  00                DCB      0
                  |L6.264|
000108  20bca4c0          DCB      " ",188,164,192,248,198,247,206,222,207,236,211,166,177,168
00010c  f8c6f7ce
000110  decfecd3
000114  a6b1a8  
000117  beaf20a3          DCB      190,175," ",163,161," \n",0
00011b  a1200a00
00011f  00                DCB      0
                  |L6.288|
000120  20b9fdc1          DCB      " ",185,253,193,247,177,168,190,175," ",163,161," \n",0
000124  f7b1a8be
000128  af20a3a1
00012c  200a00  
00012f  00                DCB      0
                  |L6.304|
000130  20c7b7d1          DCB      " ",199,183,209,185,177,168,190,175," ",163,161," \n",0
000134  b9b1a8be
000138  af20a3a1
00013c  200a00  
00013f  00                DCB      0
                  |L6.320|
000140  20b9fdd1          DCB      " ",185,253,209,185,177,168,190,175," ",163,161," \n",0
000144  b9b1a8be
000148  af20a3a1
00014c  200a00  
00014f  00                DCB      0
                  |L6.336|
000150  20d7a4b2          DCB      " ",215,164,178,168,177,200,177,168,190,175," ",163,161," "
000154  a8b1c8b1
000158  a8beaf20
00015c  a3a120  
00015f  0a00              DCB      "\n",0
000161  00                DCB      0
000162  00                DCB      0
000163  00                DCB      0
                  |L6.356|
000164  20cedeb9          DCB      " ",206,222,185,166,194,202,202,228,179,246,177,168,190,175
000168  a6c2caca
00016c  e4b3f6b1
000170  a8beaf  
000173  20a3a120          DCB      " ",163,161," \n",0
000177  0a00    
000179  00                DCB      0
00017a  00                DCB      0
00017b  00                DCB      0
                  |L6.380|
00017c  20cec2b6          DCB      " ",206,194,182,200,177,168,190,175," ",163,161," \n",0
000180  c8b1a8be
000184  af20a3a1
000188  200a00  
00018b  00                DCB      0
                  |L6.396|
00018c  20caaab6          DCB      " ",202,170,182,200,177,168,190,175," ",163,161," \n",0
000190  c8b1a8be
000194  af20a3a1
000198  200a00  
00019b  00                DCB      0

                          AREA ||i.set_alarm_bit||, CODE, READONLY, ALIGN=2

                  set_alarm_bit PROC
;;;711    /* 置位报警标志位 */
;;;712    void set_alarm_bit(void)
000000  2000              MOVS     r0,#0
;;;713    {
;;;714        Alarm_historyBack.alarm_history[0] = 0x00;
000002  4935              LDR      r1,|L7.216|
000004  7048              STRB     r0,[r1,#1]
;;;715        Alarm_historyBack.alarm_history[1] = 0x00;
000006  2100              MOVS     r1,#0
000008  4833              LDR      r0,|L7.216|
00000a  7081              STRB     r1,[r0,#2]
;;;716    
;;;717        if( Alarm.no_power == 1 )		//无功率报警		//两处：Task_Alarm()检测电压电流 和 MT2000_Rx的MT2000_Cmd_Analyze()
00000c  4833              LDR      r0,|L7.220|
00000e  7cc0              LDRB     r0,[r0,#0x13]  ; Alarm
000010  2801              CMP      r0,#1
000012  d105              BNE      |L7.32|
;;;718        {
;;;719            Alarm_historyBack.alarm_history[0] |= 1<<0;
000014  4830              LDR      r0,|L7.216|
000016  7840              LDRB     r0,[r0,#1]  ; Alarm_historyBack
000018  f0400001          ORR      r0,r0,#1
00001c  492e              LDR      r1,|L7.216|
00001e  7048              STRB     r0,[r1,#1]
                  |L7.32|
;;;720        }
;;;721    
;;;722        if(Alarm.temperature_alarm==1)	//温度报警			//Task_TH()
000020  482e              LDR      r0,|L7.220|
000022  79c0              LDRB     r0,[r0,#7]  ; Alarm
000024  2801              CMP      r0,#1
000026  d105              BNE      |L7.52|
;;;723        {
;;;724            Alarm_historyBack.alarm_history[0] |= 1<<1;
000028  482b              LDR      r0,|L7.216|
00002a  7840              LDRB     r0,[r0,#1]  ; Alarm_historyBack
00002c  f0400002          ORR      r0,r0,#2
000030  4929              LDR      r1,|L7.216|
000032  7048              STRB     r0,[r1,#1]
                  |L7.52|
;;;725        }
;;;726    
;;;727        if(Alarm.humidity_alarm==1)		//湿度报警			//Task_TH()
000034  4829              LDR      r0,|L7.220|
000036  7a40              LDRB     r0,[r0,#9]  ; Alarm
000038  2801              CMP      r0,#1
00003a  d105              BNE      |L7.72|
;;;728        {
;;;729            Alarm_historyBack.alarm_history[0] |= 1<<2;
00003c  4826              LDR      r0,|L7.216|
00003e  7840              LDRB     r0,[r0,#1]  ; Alarm_historyBack
000040  f0400004          ORR      r0,r0,#4
000044  4924              LDR      r1,|L7.216|
000046  7048              STRB     r0,[r1,#1]
                  |L7.72|
;;;730        }
;;;731    
;;;732        if(Alarm.over_Electric==1)		//过流报警			//Task_Alarm()检测电压电流
000048  4824              LDR      r0,|L7.220|
00004a  7ac0              LDRB     r0,[r0,#0xb]  ; Alarm
00004c  2801              CMP      r0,#1
00004e  d105              BNE      |L7.92|
;;;733        {
;;;734            Alarm_historyBack.alarm_history[0] |= 1<<3;
000050  4821              LDR      r0,|L7.216|
000052  7840              LDRB     r0,[r0,#1]  ; Alarm_historyBack
000054  f0400008          ORR      r0,r0,#8
000058  491f              LDR      r1,|L7.216|
00005a  7048              STRB     r0,[r1,#1]
                  |L7.92|
;;;735        }
;;;736    
;;;737        if(Alarm.over_Voltage==1)		//过压报警			//Task_Alarm()检测电压电流
00005c  481f              LDR      r0,|L7.220|
00005e  7b40              LDRB     r0,[r0,#0xd]  ; Alarm
000060  2801              CMP      r0,#1
000062  d105              BNE      |L7.112|
;;;738        {
;;;739            Alarm_historyBack.alarm_history[0] |= 1<<4;
000064  481c              LDR      r0,|L7.216|
000066  7840              LDRB     r0,[r0,#1]  ; Alarm_historyBack
000068  f0400010          ORR      r0,r0,#0x10
00006c  491a              LDR      r1,|L7.216|
00006e  7048              STRB     r0,[r1,#1]
                  |L7.112|
;;;740        }
;;;741    
;;;742        if(Alarm.low_Voltage==1)		//欠压报警			//Task_Alarm()检测电压电流
000070  481a              LDR      r0,|L7.220|
000072  7bc0              LDRB     r0,[r0,#0xf]  ; Alarm
000074  2801              CMP      r0,#1
000076  d105              BNE      |L7.132|
;;;743        {
;;;744            Alarm_historyBack.alarm_history[0] |= 1<<5;
000078  4817              LDR      r0,|L7.216|
00007a  7840              LDRB     r0,[r0,#1]  ; Alarm_historyBack
00007c  f0400020          ORR      r0,r0,#0x20
000080  4915              LDR      r1,|L7.216|
000082  7048              STRB     r0,[r1,#1]
                  |L7.132|
;;;745        }
;;;746    
;;;747        if(Alarm.swr_alarm==1)			//驻波比报警		//MT2000_Rx的MT2000_Cmd_Analyze()	(暂不通过读取AD获得功率，计算驻波比，检测报警)
000084  4815              LDR      r0,|L7.220|
000086  7c40              LDRB     r0,[r0,#0x11]  ; Alarm
000088  2801              CMP      r0,#1
00008a  d105              BNE      |L7.152|
;;;748        {
;;;749            Alarm_historyBack.alarm_history[0] |= 1<<6;
00008c  4812              LDR      r0,|L7.216|
00008e  7840              LDRB     r0,[r0,#1]  ; Alarm_historyBack
000090  f0400040          ORR      r0,r0,#0x40
000094  4910              LDR      r1,|L7.216|
000096  7048              STRB     r0,[r1,#1]
                  |L7.152|
;;;750        }
;;;751    
;;;752        if(Alarm.no_respond==1)			//激励器无响应报警	//MT2000_Rx的MT2000_Wait_Ack()
000098  4810              LDR      r0,|L7.220|
00009a  78c0              LDRB     r0,[r0,#3]  ; Alarm
00009c  2801              CMP      r0,#1
00009e  d105              BNE      |L7.172|
;;;753        {
;;;754            Alarm_historyBack.alarm_history[0] |= 1<<7;
0000a0  480d              LDR      r0,|L7.216|
0000a2  7840              LDRB     r0,[r0,#1]  ; Alarm_historyBack
0000a4  f0400080          ORR      r0,r0,#0x80
0000a8  490b              LDR      r1,|L7.216|
0000aa  7048              STRB     r0,[r1,#1]
                  |L7.172|
;;;755        }
;;;756    
;;;757        if(Alarm.emission==1)			//发射机自身报警	//MT2000_Rx的MT2000_Cmd_Analyze()
0000ac  480b              LDR      r0,|L7.220|
0000ae  7840              LDRB     r0,[r0,#1]  ; Alarm
0000b0  2801              CMP      r0,#1
0000b2  d105              BNE      |L7.192|
;;;758        {
;;;759            Alarm_historyBack.alarm_history[1] |= 1<<0;
0000b4  4808              LDR      r0,|L7.216|
0000b6  7880              LDRB     r0,[r0,#2]
0000b8  f0400101          ORR      r1,r0,#1
0000bc  4806              LDR      r0,|L7.216|
0000be  7081              STRB     r1,[r0,#2]
                  |L7.192|
;;;760        }
;;;761    		
;;;762    		if(Alarm.power_cataclysm==1)	//功率骤变报警
0000c0  4806              LDR      r0,|L7.220|
0000c2  7d40              LDRB     r0,[r0,#0x15]  ; Alarm
0000c4  2801              CMP      r0,#1
0000c6  d105              BNE      |L7.212|
;;;763    		{
;;;764    				Alarm_historyBack.alarm_history[1] |= 1<<2;		//第1位被上位机占用,往后延一位
0000c8  4803              LDR      r0,|L7.216|
0000ca  7880              LDRB     r0,[r0,#2]
0000cc  f0400104          ORR      r1,r0,#4
0000d0  4801              LDR      r0,|L7.216|
0000d2  7081              STRB     r1,[r0,#2]
                  |L7.212|
;;;765    		}
;;;766    }
0000d4  4770              BX       lr
;;;767    
                          ENDP

0000d6  0000              DCW      0x0000
                  |L7.216|
                          DCD      Alarm_historyBack
                  |L7.220|
                          DCD      Alarm

                          AREA ||i.swr_power_alarm_check||, CODE, READONLY, ALIGN=2

                  swr_power_alarm_check PROC
;;;241    /* 驻波比和无功率报警检测 */
;;;242    void swr_power_alarm_check(void)
000000  e92d47f0          PUSH     {r4-r10,lr}
;;;243    {
;;;244    		int wave_ratio=0;
000004  f04f0a00          MOV      r10,#0
;;;245    		wave_ratio=System.Standing_wave_ratio*10;
000008  4971              LDR      r1,|L8.464|
00000a  6fc8              LDR      r0,[r1,#0x7c]  ; System
00000c  4971              LDR      r1,|L8.468|
00000e  f7fffffe          BL       __aeabi_fmul
000012  4604              MOV      r4,r0
000014  f7fffffe          BL       __aeabi_f2iz
000018  4682              MOV      r10,r0
;;;246        if( (System.emission == 0x01) && (System.stop == 0x00) )	//正在发射，且没有正在停止
00001a  486d              LDR      r0,|L8.464|
00001c  7d80              LDRB     r0,[r0,#0x16]  ; System
00001e  2801              CMP      r0,#1
                  |L8.32|
000020  d17e              BNE      |L8.288|
000022  486b              LDR      r0,|L8.464|
000024  7d40              LDRB     r0,[r0,#0x15]  ; System
000026  2800              CMP      r0,#0
000028  d1fa              BNE      |L8.32|
;;;247        {
;;;248            if( wave_ratio >= SWR_ALARM_THRESHOLD && System.Reverse_Power>200)	//驻波比报警
00002a  f1ba0f18          CMP      r10,#0x18
00002e  db6b              BLT      |L8.264|
000030  4967              LDR      r1,|L8.464|
000032  6f08              LDR      r0,[r1,#0x70]  ; System
000034  4968              LDR      r1,|L8.472|
000036  f7fffffe          BL       __aeabi_cfrcmple
00003a  d265              BCS      |L8.264|
;;;249            {
;;;250                if( Alarm.swr_alarm == 0 )
00003c  4867              LDR      r0,|L8.476|
00003e  7c40              LDRB     r0,[r0,#0x11]  ; Alarm
000040  2800              CMP      r0,#0
000042  d161              BNE      |L8.264|
;;;251                {
;;;252                    if( System.time_update_flag == 0x01 )
000044  4862              LDR      r0,|L8.464|
000046  7a80              LDRB     r0,[r0,#0xa]  ; System
000048  2801              CMP      r0,#1
00004a  d12a              BNE      |L8.162|
;;;253                    {
;;;254                        Alarm.swr_alarm_time_flag = 0x01;
00004c  4963              LDR      r1,|L8.476|
00004e  7488              STRB     r0,[r1,#0x12]
;;;255                        Time_Printf( (RTC_GetCounter()+g_stamp_distance), &set_time );
000050  f7fffffe          BL       RTC_GetCounter
000054  4962              LDR      r1,|L8.480|
000056  6809              LDR      r1,[r1,#0]  ; g_stamp_distance
000058  1844              ADDS     r4,r0,r1
00005a  4962              LDR      r1,|L8.484|
00005c  4620              MOV      r0,r4
00005e  f7fffffe          BL       Time_Printf
;;;256                        Alarm_historyBack.swr_time[0]=set_time.tm_year-2000;
000062  4860              LDR      r0,|L8.484|
000064  7d00              LDRB     r0,[r0,#0x14]  ; set_time
000066  f5a060fa          SUB      r0,r0,#0x7d0
00006a  495f              LDR      r1,|L8.488|
00006c  f8810041          STRB     r0,[r1,#0x41]
;;;257                        Alarm_historyBack.swr_time[1]=set_time.tm_mon;
000070  485c              LDR      r0,|L8.484|
000072  7c01              LDRB     r1,[r0,#0x10]  ; set_time
000074  485c              LDR      r0,|L8.488|
000076  f8801042          STRB     r1,[r0,#0x42]
;;;258                        Alarm_historyBack.swr_time[2]=set_time.tm_mday;
00007a  485a              LDR      r0,|L8.484|
00007c  7b01              LDRB     r1,[r0,#0xc]  ; set_time
00007e  485a              LDR      r0,|L8.488|
000080  f8801043          STRB     r1,[r0,#0x43]
;;;259                        Alarm_historyBack.swr_time[3]=set_time.tm_hour;
000084  4857              LDR      r0,|L8.484|
000086  7a01              LDRB     r1,[r0,#8]  ; set_time
000088  4857              LDR      r0,|L8.488|
00008a  f8801044          STRB     r1,[r0,#0x44]
;;;260                        Alarm_historyBack.swr_time[4]=set_time.tm_min;
00008e  4855              LDR      r0,|L8.484|
000090  7901              LDRB     r1,[r0,#4]  ; set_time
000092  4855              LDR      r0,|L8.488|
000094  f8801045          STRB     r1,[r0,#0x45]
;;;261                        Alarm_historyBack.swr_time[5]=set_time.tm_sec;
000098  4852              LDR      r0,|L8.484|
00009a  7801              LDRB     r1,[r0,#0]  ; set_time
00009c  4852              LDR      r0,|L8.488|
00009e  f8801046          STRB     r1,[r0,#0x46]
                  |L8.162|
;;;262                    }
;;;263    							
;;;264                    Alarm.alarm_history = 1;
0000a2  2001              MOVS     r0,#1
0000a4  494d              LDR      r1,|L8.476|
0000a6  7008              STRB     r0,[r1,#0]
;;;265                    Alarm.swr_alarm = 1;
0000a8  7448              STRB     r0,[r1,#0x11]
;;;266    								if(2.2<System.Standing_wave_ratio&&System.Standing_wave_ratio<2.4)		//报警临界值小于2.4有效
0000aa  4949              LDR      r1,|L8.464|
0000ac  6fc8              LDR      r0,[r1,#0x7c]  ; System
0000ae  f7fffffe          BL       __aeabi_f2d
0000b2  4604              MOV      r4,r0
0000b4  4a4d              LDR      r2,|L8.492|
0000b6  4b4e              LDR      r3,|L8.496|
0000b8  f7fffffe          BL       __aeabi_cdrcmple
0000bc  d20e              BCS      |L8.220|
0000be  4944              LDR      r1,|L8.464|
0000c0  6fc8              LDR      r0,[r1,#0x7c]  ; System
0000c2  f7fffffe          BL       __aeabi_f2d
0000c6  4604              MOV      r4,r0
0000c8  f04f3233          MOV      r2,#0x33333333
0000cc  4b49              LDR      r3,|L8.500|
0000ce  f7fffffe          BL       __aeabi_cdcmple
0000d2  d203              BCS      |L8.220|
;;;267    								{
;;;268    									System.Standing_wave_ratio=2.2;
0000d4  4848              LDR      r0,|L8.504|
0000d6  493e              LDR      r1,|L8.464|
0000d8  67c8              STR      r0,[r1,#0x7c]  ; System
0000da  e00d              B        |L8.248|
                  |L8.220|
;;;269    								}
;;;270    								else if(System.Standing_wave_ratio>=2.4)
0000dc  493c              LDR      r1,|L8.464|
0000de  6fc8              LDR      r0,[r1,#0x7c]  ; System
0000e0  f7fffffe          BL       __aeabi_f2d
0000e4  4604              MOV      r4,r0
0000e6  f04f3233          MOV      r2,#0x33333333
0000ea  4b42              LDR      r3,|L8.500|
0000ec  f7fffffe          BL       __aeabi_cdrcmple
0000f0  d802              BHI      |L8.248|
;;;271    								{
;;;272    									System.Standing_wave_ratio=2.4;
0000f2  4842              LDR      r0,|L8.508|
0000f4  4936              LDR      r1,|L8.464|
0000f6  67c8              STR      r0,[r1,#0x7c]  ; System
                  |L8.248|
;;;273    								}
;;;274                    Alarm_historyBack.swr_alarm[0] = System.Standing_wave_ratio;	//报警值
0000f8  4835              LDR      r0,|L8.464|
0000fa  6fc0              LDR      r0,[r0,#0x7c]  ; System
0000fc  493a              LDR      r1,|L8.488|
0000fe  f8c1003d          STR      r0,[r1,#0x3d]  ; Alarm_historyBack
;;;275    								Trans_printf(" 驻波比报警1！");
000102  a03f              ADR      r0,|L8.512|
000104  f7fffffe          BL       Trans_printf
                  |L8.264|
;;;276                }
;;;277            }
;;;278    				
;;;279    //		if( (System.Forward_Power <= 10.0) && (System.Electricity >= 10.0) )	//无功率报警
;;;280    //		{
;;;281    //		
;;;282    //				if( Alarm.no_power == 0 )
;;;283    //				{
;;;284    //					if( System.time_update_flag == 0x01 )
;;;285    //					{
;;;286    //						Alarm.no_power_time_flag = 0x01;
;;;287    //						Time_Printf( (RTC_GetCounter()+g_stamp_distance), &set_time );
;;;288    //						Alarm_historyBack.no_power_time[0]=set_time.tm_year-2000;
;;;289    //						Alarm_historyBack.no_power_time[1]=set_time.tm_mon;
;;;290    //						Alarm_historyBack.no_power_time[2]=set_time.tm_mday;
;;;291    //						Alarm_historyBack.no_power_time[3]=set_time.tm_hour;
;;;292    //						Alarm_historyBack.no_power_time[4]=set_time.tm_min;
;;;293    //						Alarm_historyBack.no_power_time[5]=set_time.tm_sec;
;;;294    //					}
;;;295    
;;;296    //					Alarm.alarm_history = 1;
;;;297    //					Alarm.no_power = 1;
;;;298    //				}
;;;299    //		}
;;;300    		
;;;301    		if( (System.Reverse_Power >= 150 ) && (System.sweep != 0x01 ) )			//反向功率大于150W，且不是扫频状态
000108  4931              LDR      r1,|L8.464|
00010a  6f08              LDR      r0,[r1,#0x70]  ; System
00010c  4940              LDR      r1,|L8.528|
00010e  f7fffffe          BL       __aeabi_cfrcmple
000112  d83c              BHI      |L8.398|
000114  482e              LDR      r0,|L8.464|
000116  7b80              LDRB     r0,[r0,#0xe]  ; System
000118  2801              CMP      r0,#1
00011a  d038              BEQ      |L8.398|
;;;302    		{
;;;303    			if( System.Forward_Power < 500 )				//减小功率到500W，反向功率都大于150W，不再做处理了
00011c  492c              LDR      r1,|L8.464|
00011e  e000              B        |L8.290|
                  |L8.288|
000120  e034              B        |L8.396|
                  |L8.290|
000122  6ec8              LDR      r0,[r1,#0x6c]  ; System
000124  493b              LDR      r1,|L8.532|
000126  f7fffffe          BL       __aeabi_cfcmple
00012a  d203              BCS      |L8.308|
;;;304    			{
;;;305    				System.protect_adjust = 0x00;
00012c  2000              MOVS     r0,#0
00012e  4928              LDR      r1,|L8.464|
000130  7508              STRB     r0,[r1,#0x14]
000132  e04b              B        |L8.460|
                  |L8.308|
;;;306    			}
;;;307    			else	if( System.protect_adjust == 0x01 )		//正在减小功率，等待，不做处理
000134  4826              LDR      r0,|L8.464|
000136  7d00              LDRB     r0,[r0,#0x14]  ; System
000138  2801              CMP      r0,#1
00013a  d047              BEQ      |L8.460|
;;;308    			{
;;;309    				
;;;310    			}
;;;311    			else											//需要进入保护
;;;312    			{
;;;313    				System.protect_adjust = 0x01;
00013c  2001              MOVS     r0,#1
00013e  4924              LDR      r1,|L8.464|
000140  7508              STRB     r0,[r1,#0x14]
;;;314    				Sub_Power.Power_DOWN[0] = 50;
000142  2032              MOVS     r0,#0x32
000144  4934              LDR      r1,|L8.536|
000146  7048              STRB     r0,[r1,#1]
;;;315    				
;;;316    				if( System.modify_power == 0x01 )
000148  4821              LDR      r0,|L8.464|
00014a  7c80              LDRB     r0,[r0,#0x12]  ; System
00014c  2801              CMP      r0,#1
00014e  d102              BNE      |L8.342|
;;;317    				{
;;;318    					System.cancel_add_sub = 1;
000150  491f              LDR      r1,|L8.464|
000152  74c8              STRB     r0,[r1,#0x13]
000154  e004              B        |L8.352|
                  |L8.342|
;;;319    				}
;;;320    				else
;;;321    				{
;;;322    					System.cancel_add_sub = 0;
000156  2000              MOVS     r0,#0
000158  491d              LDR      r1,|L8.464|
00015a  74c8              STRB     r0,[r1,#0x13]
;;;323    					System.modify_power = 0x01;
00015c  2001              MOVS     r0,#1
00015e  7488              STRB     r0,[r1,#0x12]
                  |L8.352|
;;;324    				}
;;;325    
;;;326    				if( get_history_alarm() == 0x01 )
000160  f7fffffe          BL       get_history_alarm
000164  2801              CMP      r0,#1
000166  d103              BNE      |L8.368|
;;;327    				{
;;;328    					System.status = SYSTEM_ALARM;
000168  2011              MOVS     r0,#0x11
00016a  4919              LDR      r1,|L8.464|
00016c  72c8              STRB     r0,[r1,#0xb]
00016e  e002              B        |L8.374|
                  |L8.368|
;;;329    				}
;;;330    				else
;;;331    				{
;;;332    					System.status = SYSTEM_EMISSING;
000170  2001              MOVS     r0,#1
000172  4917              LDR      r1,|L8.464|
000174  72c8              STRB     r0,[r1,#0xb]
                  |L8.374|
;;;333    				}
;;;334    
;;;335    				System.stop = 0x00;
000176  2000              MOVS     r0,#0
000178  4915              LDR      r1,|L8.464|
00017a  7548              STRB     r0,[r1,#0x15]
;;;336    				System.cancel_sweeping = 0x00;
00017c  73c8              STRB     r0,[r1,#0xf]
;;;337    //				Sub_PowerBack.results[0]=0xFE;		//减小成功
;;;338    
;;;339    //				App_printf("Task_Upper_Computer Sub Notify!\r\n");
;;;340    				xTaskNotify(xHandleTask_MT2000,	/* 减小功率 */
00017e  2300              MOVS     r3,#0
000180  2201              MOVS     r2,#1
000182  2104              MOVS     r1,#4
000184  4825              LDR      r0,|L8.540|
000186  6800              LDR      r0,[r0,#0]  ; xHandleTask_MT2000
000188  f7fffffe          BL       xTaskGenericNotify
                  |L8.396|
00018c  e01e              B        |L8.460|
                  |L8.398|
;;;341    							BIT_2,
;;;342    							eSetBits);
;;;343    			}
;;;344    		}
;;;345    		else	//正常
;;;346    		{
;;;347    			if( System.Electricity >= (PROTECT_ADJUST*Alarm_threshold.Upp_45I_limit[0]) )	//虽然反向功率正常，但是电流需要保护调节，这里不做处理
00018e  4924              LDR      r1,|L8.544|
000190  6948              LDR      r0,[r1,#0x14]  ; Alarm_threshold
000192  f7fffffe          BL       __aeabi_f2d
000196  4680              MOV      r8,r0
000198  f04f3266          MOV      r2,#0x66666666
00019c  4b21              LDR      r3,|L8.548|
00019e  f7fffffe          BL       __aeabi_dmul
0001a2  4604              MOV      r4,r0
0001a4  460d              MOV      r5,r1
0001a6  490a              LDR      r1,|L8.464|
0001a8  6f88              LDR      r0,[r1,#0x78]  ; System
0001aa  f7fffffe          BL       __aeabi_f2d
0001ae  4606              MOV      r6,r0
0001b0  4622              MOV      r2,r4
0001b2  462b              MOV      r3,r5
0001b4  f7fffffe          BL       __aeabi_cdrcmple
0001b8  d908              BLS      |L8.460|
;;;348    			{
;;;349    				
;;;350    			}
;;;351    			else	if( System.protect_adjust == 0x01 )								//保护调节成功，调节结束，取消减小功率
0001ba  4805              LDR      r0,|L8.464|
0001bc  7d00              LDRB     r0,[r0,#0x14]  ; System
0001be  2801              CMP      r0,#1
0001c0  d104              BNE      |L8.460|
;;;352    			{
;;;353    				System.protect_adjust = 0x00;
0001c2  2000              MOVS     r0,#0
0001c4  4902              LDR      r1,|L8.464|
0001c6  7508              STRB     r0,[r1,#0x14]
;;;354    				System.cancel_add_sub = 0x01;
0001c8  2001              MOVS     r0,#1
0001ca  74c8              STRB     r0,[r1,#0x13]
                  |L8.460|
;;;355    			}
;;;356    			else																	//正常的增减/发射/扫频
;;;357    			{
;;;358    				
;;;359    			}
;;;360    		}
;;;361        }
;;;362    }
0001cc  e8bd87f0          POP      {r4-r10,pc}
;;;363    
                          ENDP

                  |L8.464|
                          DCD      System
                  |L8.468|
                          DCD      0x41200000
                  |L8.472|
                          DCD      0x43480000
                  |L8.476|
                          DCD      Alarm
                  |L8.480|
                          DCD      g_stamp_distance
                  |L8.484|
                          DCD      set_time
                  |L8.488|
                          DCD      Alarm_historyBack
                  |L8.492|
                          DCD      0x9999999a
                  |L8.496|
                          DCD      0x40019999
                  |L8.500|
                          DCD      0x40033333
                  |L8.504|
                          DCD      0x400ccccd
                  |L8.508|
                          DCD      0x4019999a
                  |L8.512|
000200  20d7a4b2          DCB      " ",215,164,178,168,177,200,177,168,190,175,"1",163,161,0
000204  a8b1c8b1
000208  a8beaf31
00020c  a3a100  
00020f  00                DCB      0
                  |L8.528|
                          DCD      0x43160000
                  |L8.532|
                          DCD      0x43fa0000
                  |L8.536|
                          DCD      Sub_Power
                  |L8.540|
                          DCD      xHandleTask_MT2000
                  |L8.544|
                          DCD      Alarm_threshold
                  |L8.548|
                          DCD      0x3fee6666

;*** Start embedded assembler ***

#line 1 "..\\..\\User\\alarm.c"
	AREA ||.rev16_text||, CODE
	THUMB
	EXPORT |__asm___7_alarm_c_3be810bd____REV16|
#line 114 "..\\..\\Libraries\\CMSIS\\Include\\core_cmInstr.h"
|__asm___7_alarm_c_3be810bd____REV16| PROC
#line 115

 rev16 r0, r0
 bx lr
	ENDP
	AREA ||.revsh_text||, CODE
	THUMB
	EXPORT |__asm___7_alarm_c_3be810bd____REVSH|
#line 128
|__asm___7_alarm_c_3be810bd____REVSH| PROC
#line 129

 revsh r0, r0
 bx lr
	ENDP

;*** End   embedded assembler ***
